# èŠ‚ç‚¹æž¶æž„è¯´æ˜Žï¼ˆNode Architectureï¼‰

**æ–‡æ¡£ç‰ˆæœ¬**: v8.3.1  
**æœ€åŽæ›´æ–°**: 2025å¹´12æœˆ3æ—¥  
**é€‚ç”¨ç³»ç»Ÿ**: Multi-Source Crypto Listing Automation System  
**ç»´æŠ¤è€…**: Brian  

---

## æ¦‚è¿°

æœ¬ç³»ç»Ÿé‡‡ç”¨åˆ†å¸ƒå¼å¤šèŠ‚ç‚¹æž¶æž„ï¼Œç”±ä¸‰ä¸ªåœ°ç†åˆ†å¸ƒçš„é‡‡é›†èŠ‚ç‚¹å’Œä¸€ä¸ªä¸­å¿ƒåŒ–çš„RedisèžåˆæœåŠ¡å™¨ç»„æˆã€‚æ¯ä¸ªèŠ‚ç‚¹æ‰¿æ‹…ç‰¹å®šçš„æ•°æ®é‡‡é›†èŒè´£ï¼Œé€šè¿‡Redis Streamså®žçŽ°å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ï¼Œæœ€ç»ˆç”±Fusion Engineè¿›è¡Œä¿¡å·èžåˆå’Œè¯„åˆ†ã€‚

**èŠ‚ç‚¹æ‹“æ‰‘æ€»è§ˆ**:

```
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚       INTERNET              â”‚
                         â”‚   (External Data Sources)   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                            â”‚                            â”‚
           â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      NODE A ðŸ‡¯ðŸ‡µ      â”‚    â”‚      NODE B ðŸ‡¸ðŸ‡¬      â”‚    â”‚      NODE C ðŸ‡°ðŸ‡·      â”‚
â”‚    45.76.193.208    â”‚    â”‚    45.77.168.238    â”‚    â”‚   158.247.222.198   â”‚
â”‚      Tokyo          â”‚    â”‚      Singapore      â”‚    â”‚       Seoul         â”‚
â”‚                     â”‚    â”‚                     â”‚    â”‚                     â”‚
â”‚ â€¢ 13 Exchanges      â”‚    â”‚ â€¢ ETH/BNB/SOL Chain â”‚    â”‚ â€¢ 5 Korean Exch.    â”‚
â”‚ â€¢ WebSocket + REST  â”‚    â”‚ â€¢ Twitter API       â”‚    â”‚ â€¢ 51 TG Channels    â”‚
â”‚ â€¢ collector_a.py    â”‚    â”‚ â€¢ collector_b.py    â”‚    â”‚ â€¢ collector_c.py    â”‚
â”‚                     â”‚    â”‚                     â”‚    â”‚ â€¢ telegram_monitor  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                          â”‚                          â”‚
           â”‚         Redis Stream: events:raw                    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚    REDIS SERVER ðŸ‡¸ðŸ‡¬         â”‚
                         â”‚     139.180.133.81         â”‚
                         â”‚       Singapore            â”‚
                         â”‚                            â”‚
                         â”‚  â€¢ Fusion Engine           â”‚
                         â”‚  â€¢ Signal Router           â”‚
                         â”‚  â€¢ Webhook Pusher          â”‚
                         â”‚  â€¢ CEX Executor            â”‚
                         â”‚  â€¢ Dashboard (:5000/:5001) â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®¾è®¡åŽŸåˆ™**:

| åŽŸåˆ™ | è¯´æ˜Ž |
|------|------|
| åœ°ç†å°±è¿‘ | èŠ‚ç‚¹éƒ¨ç½²åœ¨æ•°æ®æºæ‰€åœ¨åŒºåŸŸï¼Œæœ€å°åŒ–ç½‘ç»œå»¶è¿Ÿ |
| èŒè´£å•ä¸€ | æ¯ä¸ªèŠ‚ç‚¹ä¸“æ³¨ç‰¹å®šæ•°æ®æºç±»åž‹ï¼Œä¾¿äºŽç‹¬ç«‹æ‰©å±•å’Œç»´æŠ¤ |
| æ•…éšœéš”ç¦» | å•èŠ‚ç‚¹æ•…éšœä¸å½±å“å…¶ä»–èŠ‚ç‚¹ï¼Œç³»ç»Ÿå…·å¤‡éƒ¨åˆ†é™çº§èƒ½åŠ› |
| å¼‚æ­¥è§£è€¦ | é€šè¿‡Redis Streamså®žçŽ°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œå„ç»„ä»¶æ¾è€¦åˆ |
| å¿ƒè·³ç›‘æŽ§ | æ‰€æœ‰èŠ‚ç‚¹å®šæœŸä¸ŠæŠ¥å¿ƒè·³ï¼Œæ”¯æŒå¥åº·æ£€æµ‹å’Œå‘Šè­¦ |

---

## 1. Node A - äº¤æ˜“æ‰€å®žæ—¶ç›‘æŽ§èŠ‚ç‚¹

Node Aæ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒæ•°æ®é‡‡é›†èŠ‚ç‚¹ï¼Œéƒ¨ç½²åœ¨æ—¥æœ¬ä¸œäº¬ï¼Œè´Ÿè´£ç›‘æŽ§å…¨çƒ13å®¶ä¸»æµåŠ å¯†è´§å¸äº¤æ˜“æ‰€çš„å®žæ—¶å¸‚åœºæ•°æ®å’Œä¸Šå¸å…¬å‘Šã€‚è¯¥èŠ‚ç‚¹åŒæ—¶è¿è¡ŒWebSocketé•¿è¿žæŽ¥å’ŒREST APIè½®è¯¢ä¸¤ç§é‡‡é›†æ¨¡å¼ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®žæ—¶æ€§å’Œå®Œæ•´æ€§ã€‚

### 1.1 è§’è‰²ä¸ŽèŒè´£

**éƒ¨ç½²ä¿¡æ¯**:

| å±žæ€§ | å€¼ |
|------|-----|
| æœåŠ¡å™¨IP | 45.76.193.208 |
| åœ°ç†ä½ç½® | ðŸ‡¯ðŸ‡µ æ—¥æœ¬ä¸œäº¬ |
| æœåŠ¡å™¨è§„æ ¼ | 2vCPU / 4GB RAM |
| æ“ä½œç³»ç»Ÿ | Ubuntu 24.04 LTS |
| Pythonç‰ˆæœ¬ | 3.10+ |
| systemdæœåŠ¡ | collector_a.service |
| ä»£ç è·¯å¾„ | /root/v8.3_crypto_monitor/node_a/ |
| é…ç½®æ–‡ä»¶ | /root/v8.3_crypto_monitor/node_a/config.yaml |

**æ ¸å¿ƒèŒè´£**:

1. **WebSocketå®žæ—¶ç›‘æŽ§**: é€šè¿‡WebSocketé•¿è¿žæŽ¥æŽ¥æ”¶Binanceç­‰äº¤æ˜“æ‰€çš„å®žæ—¶äº¤æ˜“å¯¹å˜æ›´æŽ¨é€ï¼Œå»¶è¿Ÿåœ¨æ¯«ç§’çº§åˆ«ã€‚

2. **REST APIè½®è¯¢**: ä»¥5ç§’é—´éš”è½®è¯¢å„äº¤æ˜“æ‰€çš„å…¬å‘ŠAPIå’Œäº¤æ˜“å¯¹åˆ—è¡¨APIï¼Œæ£€æµ‹æ–°ä¸Šå¸å’Œäº¤æ˜“å¯¹å˜æ›´ã€‚

3. **äº‹ä»¶æ ‡å‡†åŒ–**: å°†ä¸åŒäº¤æ˜“æ‰€çš„å¼‚æž„æ•°æ®æ ¼å¼è½¬æ¢ä¸ºç»Ÿä¸€çš„Raw Eventç»“æž„ã€‚

4. **RedisæŽ¨é€**: å°†æ£€æµ‹åˆ°çš„äº‹ä»¶æŽ¨é€è‡³Redis Stream `events:raw`ï¼Œä¾›Fusion Engineæ¶ˆè´¹ã€‚

5. **å¿ƒè·³ä¸ŠæŠ¥**: æ¯30ç§’å‘Rediså†™å…¥å¿ƒè·³æ•°æ®ï¼ŒåŒ…å«é‡‡é›†ç»Ÿè®¡å’Œé”™è¯¯è®¡æ•°ã€‚

**è¾“å…¥**:
- Binance WebSocketå®žæ—¶æ•°æ®æµ
- 13å®¶äº¤æ˜“æ‰€REST APIå“åº”

**è¾“å‡º**:
- Redis Stream `events:raw` ä¸­çš„æ ‡å‡†åŒ–äº‹ä»¶
- Redis Hash `node:heartbeat:NODE_A` å¿ƒè·³æ•°æ®

**ä¾èµ–å…³ç³»**:
- å¤–éƒ¨ä¾èµ–: äº¤æ˜“æ‰€APIç«¯ç‚¹ï¼ˆéœ€ç½‘ç»œå¯è¾¾ï¼‰
- å†…éƒ¨ä¾èµ–: Redis Server (139.180.133.81:6379)
- Pythonåº“: aiohttp, websockets, redis-py, pyyaml

---

### 1.2 ç›‘æŽ§äº¤æ˜“æ‰€åˆ—è¡¨

Node Aç›‘æŽ§çš„13å®¶äº¤æ˜“æ‰€æŒ‰å¸‚åœºå½±å“åŠ›åˆ†ä¸ºä¸‰ä¸ªå±‚çº§ï¼Œä¸åŒå±‚çº§åœ¨è¯„åˆ†ç³»ç»Ÿä¸­å…·æœ‰ä¸åŒçš„æƒé‡ã€‚

**Tier 1 - å¤´éƒ¨äº¤æ˜“æ‰€**:

| äº¤æ˜“æ‰€ | ç›‘æŽ§æ–¹å¼ | APIç«¯ç‚¹ | è½®è¯¢é—´éš” | è¯„åˆ†æƒé‡ |
|--------|----------|---------|----------|----------|
| Binance | WebSocket + REST | wss://stream.binance.com:9443/ws/!ticker@arr | å®žæ—¶ | 1.5x |
| Coinbase | REST | https://api.coinbase.com/v2/currencies | 5s | 1.4x |
| Kraken | REST | https://api.kraken.com/0/public/AssetPairs | 5s | 1.15x |

**Tier 2 - ä¸»æµäº¤æ˜“æ‰€**:

| äº¤æ˜“æ‰€ | ç›‘æŽ§æ–¹å¼ | APIç«¯ç‚¹ | è½®è¯¢é—´éš” | è¯„åˆ†æƒé‡ |
|--------|----------|---------|----------|----------|
| OKX | REST | https://www.okx.com/api/v5/public/instruments | 5s | 1.4x |
| Bybit | REST | https://api.bybit.com/v5/market/instruments-info | 5s | 1.2x |
| KuCoin | REST | https://api.kucoin.com/api/v1/symbols | 5s | 1.05x |

**Tier 3 - äºŒçº¿äº¤æ˜“æ‰€**:

| äº¤æ˜“æ‰€ | ç›‘æŽ§æ–¹å¼ | APIç«¯ç‚¹ | è½®è¯¢é—´éš” | è¯„åˆ†æƒé‡ |
|--------|----------|---------|----------|----------|
| Gate.io | REST | https://api.gateio.ws/api/v4/spot/currency_pairs | 5s | 1.1x |
| Bitget | REST | https://api.bitget.com/api/spot/v1/public/products | 5s | 1.0x |
| HTX | REST | https://api.huobi.pro/v1/common/symbols | 5s | 0.85x |
| MEXC | REST | https://api.mexc.com/api/v3/exchangeInfo | 5s | 0.9x |
| BingX | REST | https://open-api.bingx.com/openApi/spot/v1/common/symbols | 5s | 1.0x |
| Phemex | REST | https://api.phemex.com/public/products | 5s | 1.0x |
| WhiteBIT | REST | https://whitebit.com/api/v4/public/markets | 5s | 1.0x |

**Binance WebSocketé…ç½®è¯¦æƒ…**:

```yaml
binance_websocket:
  endpoint: "wss://stream.binance.com:9443/ws/!ticker@arr"
  reconnect_interval: 5  # ç§’
  ping_interval: 30      # ç§’
  pong_timeout: 10       # ç§’
  message_queue_size: 1000
  
  monitored_streams:
    - "!ticker@arr"           # æ‰€æœ‰äº¤æ˜“å¯¹è¡Œæƒ…
    - "!miniTicker@arr"       # è¿·ä½ è¡Œæƒ…
    
  event_filters:
    - new_symbol_detection    # æ–°äº¤æ˜“å¯¹æ£€æµ‹
    - status_change           # äº¤æ˜“çŠ¶æ€å˜æ›´
```

---

### 1.3 é‡‡é›†é€»è¾‘æµç¨‹å›¾

Node Açš„é‡‡é›†é€»è¾‘é‡‡ç”¨å¼‚æ­¥å¹¶å‘æž¶æž„ï¼ŒåŒæ—¶è¿è¡ŒWebSocketç›‘å¬å™¨å’ŒRESTè½®è¯¢å™¨ï¼Œé€šè¿‡å†…éƒ¨äº‹ä»¶é˜Ÿåˆ—æ±‡èšåŽç»Ÿä¸€æŽ¨é€è‡³Redisã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           NODE A - collector_a.py                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        ASYNC EVENT LOOP                              â”‚   â”‚
â”‚  â”‚                         (asyncio)                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚            â”‚                       â”‚                       â”‚               â”‚
â”‚            â–¼                       â–¼                       â–¼               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   WebSocket     â”‚    â”‚   REST Poller   â”‚    â”‚   REST Poller   â”‚        â”‚
â”‚  â”‚   Listener      â”‚    â”‚   (Tier 1)      â”‚    â”‚   (Tier 2/3)    â”‚        â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚        â”‚
â”‚  â”‚ â€¢ Binance WS    â”‚    â”‚ â€¢ Coinbase      â”‚    â”‚ â€¢ Gate.io       â”‚        â”‚
â”‚  â”‚ â€¢ Real-time     â”‚    â”‚ â€¢ Kraken        â”‚    â”‚ â€¢ Bitget        â”‚        â”‚
â”‚  â”‚ â€¢ Auto-reconnectâ”‚    â”‚ â€¢ OKX           â”‚    â”‚ â€¢ MEXC          â”‚        â”‚
â”‚  â”‚                 â”‚    â”‚ â€¢ Bybit         â”‚    â”‚ â€¢ HTX           â”‚        â”‚
â”‚  â”‚                 â”‚    â”‚ â€¢ KuCoin        â”‚    â”‚ â€¢ BingX...      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚           â”‚                      â”‚                      â”‚                  â”‚
â”‚           â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚           â”‚    â”‚                                                           â”‚
â”‚           â–¼    â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      INTERNAL EVENT QUEUE                            â”‚   â”‚
â”‚  â”‚                       (asyncio.Queue)                                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â€¢ Deduplication (5s window)                                         â”‚   â”‚
â”‚  â”‚  â€¢ Rate limiting (100 events/sec)                                    â”‚   â”‚
â”‚  â”‚  â€¢ Event normalization                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      KNOWN PAIRS CACHE                               â”‚   â”‚
â”‚  â”‚                       (Redis Set)                                    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Key: known:pairs:{exchange}                                         â”‚   â”‚
â”‚  â”‚  â€¢ Check if symbol exists                                            â”‚   â”‚
â”‚  â”‚  â€¢ Add new symbols                                                   â”‚   â”‚
â”‚  â”‚  â€¢ TTL: 24 hours                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                          â”‚   New Symbol?     â”‚                             â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                    â”‚                                        â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                    â”‚ YES           â”‚               â”‚ NO                    â”‚
â”‚                    â–¼               â”‚               â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  CREATE RAW EVENT   â”‚          â”‚    â”‚      SKIP           â”‚            â”‚
â”‚  â”‚                     â”‚          â”‚    â”‚  (Already known)    â”‚            â”‚
â”‚  â”‚  {                  â”‚          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚  â”‚    source: ws_*     â”‚          â”‚                                       â”‚
â”‚  â”‚    exchange: *      â”‚          â”‚                                       â”‚
â”‚  â”‚    symbol: NEW      â”‚          â”‚                                       â”‚
â”‚  â”‚    event: listing   â”‚          â”‚                                       â”‚
â”‚  â”‚    detected_at: ts  â”‚          â”‚                                       â”‚
â”‚  â”‚  }                  â”‚          â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                                       â”‚
â”‚             â”‚                      â”‚                                       â”‚
â”‚             â–¼                      â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      REDIS STREAM PUBLISHER                          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  XADD events:raw * source ws_binance exchange binance ...            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â€¢ Batch publishing (up to 10 events)                                â”‚   â”‚
â”‚  â”‚  â€¢ Retry on failure (3 attempts)                                     â”‚   â”‚
â”‚  â”‚  â€¢ Connection pooling                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é‡‡é›†æµç¨‹è¯¦ç»†è¯´æ˜Ž**:

1. **WebSocketè¿žæŽ¥ç®¡ç†**: ç³»ç»Ÿå¯åŠ¨æ—¶å»ºç«‹ä¸ŽBinanceçš„WebSocketè¿žæŽ¥ï¼Œè®¢é˜…`!ticker@arr`æµã€‚è¿žæŽ¥æ–­å¼€æ—¶è‡ªåŠ¨é‡è¿žï¼Œé‡è¿žé—´éš”5ç§’ã€‚

2. **RESTè½®è¯¢è°ƒåº¦**: ä½¿ç”¨asyncioå¹¶å‘æ‰§è¡Œå¤šä¸ªäº¤æ˜“æ‰€çš„REST APIè°ƒç”¨ï¼Œæ¯5ç§’ä¸€ä¸ªè½®è¯¢å‘¨æœŸã€‚é‡‡ç”¨ä¿¡å·é‡æŽ§åˆ¶å¹¶å‘æ•°ï¼Œé¿å…è¿‡å¤šè¯·æ±‚ã€‚

3. **äº‹ä»¶é˜Ÿåˆ—æ±‡èš**: WebSocketå’ŒRESTé‡‡é›†çš„æ•°æ®ç»Ÿä¸€è¿›å…¥å†…éƒ¨é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—æ¶ˆè´¹è€…è´Ÿè´£åŽ»é‡å’Œæ ‡å‡†åŒ–ã€‚

4. **å·²çŸ¥äº¤æ˜“å¯¹ç¼“å­˜**: ä½¿ç”¨Redis Setå­˜å‚¨æ¯ä¸ªäº¤æ˜“æ‰€çš„å·²çŸ¥äº¤æ˜“å¯¹ï¼Œåªæœ‰æ–°å‡ºçŽ°çš„äº¤æ˜“å¯¹æ‰ä¼šè§¦å‘äº‹ä»¶ç”Ÿæˆã€‚

5. **RedisæŽ¨é€**: æ ‡å‡†åŒ–åŽçš„äº‹ä»¶é€šè¿‡XADDå‘½ä»¤å†™å…¥`events:raw` Streamï¼Œæ”¯æŒæ‰¹é‡å†™å…¥å’Œå¤±è´¥é‡è¯•ã€‚

---

### 1.4 å¿ƒè·³æœºåˆ¶

Node Aæ¯30ç§’å‘Rediså†™å…¥ä¸€æ¬¡å¿ƒè·³æ•°æ®ï¼ŒåŒ…å«èŠ‚ç‚¹çŠ¶æ€å’Œé‡‡é›†ç»Ÿè®¡ä¿¡æ¯ã€‚Dashboardå’Œå‘Šè­¦ç³»ç»Ÿé€šè¿‡è¯»å–å¿ƒè·³åˆ¤æ–­èŠ‚ç‚¹å¥åº·çŠ¶å†µã€‚

**å¿ƒè·³Key**: `node:heartbeat:NODE_A`

**å¿ƒè·³æ•°æ®ç»“æž„**:

```json
{
  "status": "running",
  "node_id": "NODE_A",
  "version": "v8.3.1",
  "uptime_seconds": 86400,
  "timestamp": 1764590430000,
  "stats": {
    "events_collected": 15234,
    "events_pushed": 15230,
    "errors": 4,
    "last_event_at": 1764590420000,
    "exchanges_active": {
      "binance": true,
      "okx": true,
      "bybit": true,
      "gate": true,
      "kucoin": true,
      "bitget": true,
      "coinbase": true,
      "kraken": true,
      "htx": true,
      "mexc": true,
      "bingx": true,
      "phemex": true,
      "whitebit": true
    },
    "ws_connections": 1,
    "ws_reconnects": 3,
    "rest_calls": 8547,
    "rest_errors": 12
  }
}
```

**å¿ƒè·³å†™å…¥ä»£ç é€»è¾‘**:

```python
async def send_heartbeat(self):
    """æ¯30ç§’å‘é€ä¸€æ¬¡å¿ƒè·³"""
    while True:
        try:
            heartbeat = {
                "status": "running",
                "node_id": "NODE_A",
                "version": self.version,
                "uptime_seconds": int(time.time() - self.start_time),
                "timestamp": int(time.time() * 1000),
                "stats": json.dumps(self.stats)
            }
            self.redis.hset("node:heartbeat:NODE_A", mapping=heartbeat)
            self.redis.expire("node:heartbeat:NODE_A", 120)  # 2åˆ†é’Ÿè¿‡æœŸ
        except Exception as e:
            logger.error(f"å¿ƒè·³å‘é€å¤±è´¥: {e}")
        
        await asyncio.sleep(30)
```

**å¥åº·åˆ¤æ–­è§„åˆ™**:
- å¿ƒè·³è¶…è¿‡90ç§’æœªæ›´æ–°: èŠ‚ç‚¹å¯èƒ½ç¦»çº¿
- å¿ƒè·³è¶…è¿‡120ç§’æœªæ›´æ–°: èŠ‚ç‚¹ç¡®è®¤ç¦»çº¿
- errorsè®¡æ•°æŒç»­å¢žåŠ : éœ€è¦äººå·¥æ£€æŸ¥
- exchanges_activeå…¨ä¸ºfalse: APIè¿žæŽ¥é—®é¢˜

---

### 1.5 é”™è¯¯é‡è¯•ä¸Žä¿æŠ¤æœºåˆ¶

Node Aå®žçŽ°äº†å¤šå±‚é”™è¯¯å¤„ç†å’Œä¿æŠ¤æœºåˆ¶ï¼Œç¡®ä¿å•ç‚¹æ•…éšœä¸ä¼šå¯¼è‡´æ•´ä½“é‡‡é›†ä¸­æ–­ã€‚

**WebSocketé‡è¿žæœºåˆ¶**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  WebSocket Reconnection                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Connection    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ INITIAL  â”‚â”€â”€â”€â”€â”€â”€â”€Lostâ”€â”€â”€â”€â”€â”€â”€â–¶â”‚ WAITING  â”‚                 â”‚
â”‚  â”‚          â”‚                   â”‚  (5s)    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚       â–²                              â”‚                       â”‚
â”‚       â”‚                         Reconnect                    â”‚
â”‚       â”‚                         Attempt                      â”‚
â”‚       â”‚                              â”‚                       â”‚
â”‚       â”‚                              â–¼                       â”‚
â”‚       â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚       â”‚          Success       â”‚CONNECTINGâ”‚                  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚                  â”‚
â”‚                                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                     â”‚                        â”‚
â”‚                                  Failure                     â”‚
â”‚                                     â”‚                        â”‚
â”‚                                     â–¼                        â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                              â”‚ BACKOFF  â”‚                    â”‚
â”‚                              â”‚ (exp)    â”‚                    â”‚
â”‚                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                   â”‚                          â”‚
â”‚                      Max 5 attempts, then alert              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é‡è¯•é…ç½®**:

```yaml
retry_policy:
  websocket:
    initial_delay: 5        # åˆå§‹é‡è¿žå»¶è¿Ÿï¼ˆç§’ï¼‰
    max_delay: 60           # æœ€å¤§é‡è¿žå»¶è¿Ÿï¼ˆç§’ï¼‰
    backoff_multiplier: 2   # æŒ‡æ•°é€€é¿ä¹˜æ•°
    max_attempts: 10        # æœ€å¤§é‡è¯•æ¬¡æ•°
    
  rest_api:
    max_retries: 3          # å•æ¬¡è¯·æ±‚æœ€å¤§é‡è¯•
    retry_delay: 1          # é‡è¯•é—´éš”ï¼ˆç§’ï¼‰
    timeout: 10             # è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰
    
  redis:
    max_retries: 5          # Redisæ“ä½œæœ€å¤§é‡è¯•
    retry_delay: 2          # é‡è¯•é—´éš”ï¼ˆç§’ï¼‰
    connection_pool_size: 10
```

**ç†”æ–­ä¿æŠ¤æœºåˆ¶**:

å½“æŸä¸ªäº¤æ˜“æ‰€è¿žç»­å¤±è´¥è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨ç†”æ–­è¯¥äº¤æ˜“æ‰€çš„é‡‡é›†ï¼Œé¿å…æ— æ•ˆè¯·æ±‚æµªè´¹èµ„æºã€‚

```python
class CircuitBreaker:
    def __init__(self, failure_threshold=5, recovery_timeout=300):
        self.failure_count = 0
        self.failure_threshold = failure_threshold
        self.recovery_timeout = recovery_timeout  # 5åˆ†é’Ÿ
        self.state = "CLOSED"  # CLOSED, OPEN, HALF_OPEN
        self.last_failure_time = None
    
    def record_failure(self):
        self.failure_count += 1
        self.last_failure_time = time.time()
        if self.failure_count >= self.failure_threshold:
            self.state = "OPEN"
            logger.warning(f"ç†”æ–­å™¨å¼€å¯ï¼Œæš‚åœé‡‡é›†")
    
    def can_execute(self):
        if self.state == "CLOSED":
            return True
        if self.state == "OPEN":
            if time.time() - self.last_failure_time > self.recovery_timeout:
                self.state = "HALF_OPEN"
                return True
            return False
        if self.state == "HALF_OPEN":
            return True
        return False
```

**é”™è¯¯åˆ†ç±»ä¸Žå¤„ç†**:

| é”™è¯¯ç±»åž‹ | å¤„ç†ç­–ç•¥ | æ˜¯å¦é‡è¯• | æ˜¯å¦å‘Šè­¦ |
|----------|----------|----------|----------|
| ç½‘ç»œè¶…æ—¶ | æŒ‡æ•°é€€é¿é‡è¯• | âœ… | âŒ (å°‘é‡) |
| HTTP 429 (é™æµ) | ç­‰å¾…åŽé‡è¯• | âœ… | âš ï¸ (æŒç»­æ—¶) |
| HTTP 5xx | æŒ‡æ•°é€€é¿é‡è¯• | âœ… | âš ï¸ (æŒç»­æ—¶) |
| HTTP 4xx | è·³è¿‡æœ¬æ¬¡ | âŒ | âœ… |
| JSONè§£æžé”™è¯¯ | è®°å½•æ—¥å¿—ï¼Œè·³è¿‡ | âŒ | âŒ |
| Redisè¿žæŽ¥å¤±è´¥ | ç«‹å³é‡è¯• | âœ… | âœ… |
| WebSocketæ–­å¼€ | è‡ªåŠ¨é‡è¿ž | âœ… | âš ï¸ (é¢‘ç¹æ—¶) |

---

## 2. Node B - åŒºå—é“¾ä¸Žç¤¾äº¤åª’ä½“ç›‘æŽ§èŠ‚ç‚¹

Node Béƒ¨ç½²åœ¨æ–°åŠ å¡ï¼Œè´Ÿè´£ç›‘æŽ§ä»¥å¤ªåŠã€BNB Chainã€Solanaç­‰ä¸»æµåŒºå—é“¾çš„DEXæ´»åŠ¨ï¼Œä»¥åŠTwitterä¸Šäº¤æ˜“æ‰€å®˜æ–¹è´¦å·çš„åŠ¨æ€ã€‚è¯¥èŠ‚ç‚¹èƒ½å¤Ÿåœ¨äº¤æ˜“æ‰€æ­£å¼å…¬å‘Šå‰ï¼Œé€šè¿‡é“¾ä¸ŠæµåŠ¨æ€§å˜åŒ–æå‰å‘çŽ°æ–°é¡¹ç›®ã€‚

### 2.1 é“¾ä¸Šç›‘æŽ§å†…å®¹

**éƒ¨ç½²ä¿¡æ¯**:

| å±žæ€§ | å€¼ |
|------|-----|
| æœåŠ¡å™¨IP | 45.77.168.238 |
| åœ°ç†ä½ç½® | ðŸ‡¸ðŸ‡¬ æ–°åŠ å¡ |
| æœåŠ¡å™¨è§„æ ¼ | 2vCPU / 4GB RAM |
| systemdæœåŠ¡ | collector_b.service |
| ä»£ç è·¯å¾„ | /root/v8.3_crypto_monitor/node_b/ |
| é…ç½®æ–‡ä»¶ | /root/v8.3_crypto_monitor/node_b/config.yaml |

**ç›‘æŽ§é“¾ä¸ŽRPCé…ç½®**:

| é“¾ | RPCæä¾›å•† | ç«¯ç‚¹ | è½®è¯¢é—´éš” |
|----|-----------|------|----------|
| Ethereum | Alchemy | https://eth-mainnet.g.alchemy.com/v2/_1WESPntw1rwPyodMzDFF | 12s |
| Ethereum | Infura (å¤‡ç”¨) | https://mainnet.infura.io/v3/dfd9336c60d7442b8c4b310bf42a422d | 12s |
| BNB Chain | Alchemy | https://bnb-mainnet.g.alchemy.com/v2/HflDOcVtGYSn-AFkUfW4l | 10s |
| Solana | QuickNode | https://cosmopolitan-thrilling-ensemble.solana-mainnet.quiknode.pro/1b629c939576527eb372e9beec30c2ee629c319c/ | 10s |
| Arbitrum | Public RPC | https://arb1.arbitrum.io/rpc | 10s |

**ç›‘æŽ§åˆçº¦åˆ—è¡¨**:

```yaml
ethereum:
  contracts:
    - name: "Uniswap V2 Factory"
      address: "0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f"
      event: "PairCreated"
      abi_signature: "PairCreated(address,address,address,uint256)"
      
    - name: "Uniswap V3 Factory"
      address: "0x1F98431c8aD98523631AE4a59f267346ea31F984"
      event: "PoolCreated"
      abi_signature: "PoolCreated(address,address,uint24,int24,address)"
      
    - name: "SushiSwap Factory"
      address: "0xC0AEe478e3658e2610c5F7A4A2E1777cE9e4f2Ac"
      event: "PairCreated"
      abi_signature: "PairCreated(address,address,address,uint256)"

bnb_chain:
  contracts:
    - name: "PancakeSwap V2 Factory"
      address: "0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73"
      event: "PairCreated"
      
    - name: "PancakeSwap V3 Factory"
      address: "0x0BFbCF9fa4f9C56B0F40a671Ad40E0805A091865"
      event: "PoolCreated"

solana:
  programs:
    - name: "Raydium AMM"
      program_id: "675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"
      instruction: "initialize2"
      
    - name: "Orca Whirlpool"
      program_id: "whirLbMiicVdio4qvUfM5KAg6Ct8VwpYzGff3uctyCc"
      instruction: "initializePool"
```

**é“¾ä¸Šç›‘æŽ§æµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ON-CHAIN MONITORING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ETH Monitor   â”‚    â”‚   BNB Monitor   â”‚    â”‚  SOL Monitorâ”‚ â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚             â”‚ â”‚
â”‚  â”‚ â€¢ Alchemy RPC   â”‚    â”‚ â€¢ Alchemy RPC   â”‚    â”‚ â€¢ QuickNode â”‚ â”‚
â”‚  â”‚ â€¢ 12s interval  â”‚    â”‚ â€¢ 10s interval  â”‚    â”‚ â€¢ 10s intv. â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                      â”‚                     â”‚        â”‚
â”‚           â–¼                      â–¼                     â–¼        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    eth_getLogs / getProgramAccounts          â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  Filter by:                                                  â”‚â”‚
â”‚  â”‚  â€¢ Contract address                                          â”‚â”‚
â”‚  â”‚  â€¢ Event topic (PairCreated, PoolCreated)                    â”‚â”‚
â”‚  â”‚  â€¢ Block range (last N blocks)                               â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                     EVENT DECODER                            â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ Decode log data using ABI                                 â”‚â”‚
â”‚  â”‚  â€¢ Extract token0, token1, pair address                      â”‚â”‚
â”‚  â”‚  â€¢ Fetch token metadata (symbol, name, decimals)             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                   LIQUIDITY FILTER                           â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ Check initial liquidity (>$1000 threshold)                â”‚â”‚
â”‚  â”‚  â€¢ Verify token contract (not honeypot)                      â”‚â”‚
â”‚  â”‚  â€¢ Check pair age (<1 hour = new)                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                   PUSH TO REDIS                              â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  source: chain_contract                                      â”‚â”‚
â”‚  â”‚  event: pair_created                                         â”‚â”‚
â”‚  â”‚  chain.network: ethereum                                     â”‚â”‚
â”‚  â”‚  chain.contract_address: 0x5C69...                           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2.2 Twitter ç›‘æŽ§é€»è¾‘

Node BåŒæ—¶ç›‘æŽ§Twitterä¸Šçš„äº¤æ˜“æ‰€å®˜æ–¹è´¦å·å’ŒçŸ¥åKOLï¼Œç”¨äºŽæ•èŽ·å¯èƒ½çš„ä¸Šå¸é¢„å‘Šå’Œå¸‚åœºåŠ¨æ€ã€‚ç”±äºŽTwitter Free APIçš„ä¸¥æ ¼é™æµï¼ˆ429é”™è¯¯ï¼‰ï¼Œè¯¥åŠŸèƒ½ç›®å‰å¤„äºŽå—é™çŠ¶æ€ã€‚

**Twitter APIé…ç½®**:

```yaml
twitter:
  bearer_token: "AAAAAAAAAAAAAAAAAAAAALV85gEAAAAAjbxUkJ1HRwUxKvtbNtAqjraBFfE%3DKAUKgVYXt4wZnAV4kT0x3GyhIqhfNmoAsDtkjwGtLtOA35DtGP"
  api_key: "ykZiZrAyktX0xzmBeqr2YiM7n"
  api_key_secret: "xPJwysEIptPm5haaEm32C0GLjdnBY2KXgdM3OEMn0rKhj8x61y"
  access_token: "1743632124853538816-50HSeJdlZ3enwdpx2UW5enDvRUowon"
  access_token_secret: "Imer1yV5RpSp3PoPjP7UCy6Qd5pXQw7qNTJXmD5m3sfP1"
  
  rate_limits:
    requests_per_15min: 15  # Free tieré™åˆ¶
    
  monitored_accounts:
    tier_s:  # äº¤æ˜“æ‰€å®˜æ–¹
      - username: "binance"
        user_id: "877807935493033984"
        score_weight: 55
      - username: "okx"
        user_id: "2312333412"
        score_weight: 53
      - username: "gate_io"
        user_id: "871505425977626624"
        score_weight: 45
      - username: "Bybit_Official"
        user_id: "1068118984884318208"
        score_weight: 50
      - username: "kucoincom"
        user_id: "831aboraties"
        score_weight: 45
        
    tier_a:  # çŸ¥åKOL
      - username: "lookonchain"
        score_weight: 40
      - username: "spotonchain"
        score_weight: 38
      - username: "whale_alert"
        score_weight: 35
      - username: "wublockchain"
        score_weight: 33
```

**Twitterç›‘æŽ§æµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     TWITTER MONITORING                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                  RATE LIMITER                                â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ 15 requests / 15 minutes (Free tier)                      â”‚â”‚
â”‚  â”‚  â€¢ Token bucket algorithm                                    â”‚â”‚
â”‚  â”‚  â€¢ Exponential backoff on 429                                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚               TWITTER API v2 CLIENT                          â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  Endpoint: GET /2/users/:id/tweets                           â”‚â”‚
â”‚  â”‚  â€¢ Fetch recent tweets from monitored accounts               â”‚â”‚
â”‚  â”‚  â€¢ Round-robin through account list                          â”‚â”‚
â”‚  â”‚  â€¢ Store last_tweet_id for pagination                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                  KEYWORD MATCHER                             â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  Keywords: listing, list, launch, trading, deposit           â”‚â”‚
â”‚  â”‚            ä¸Šå¸, ä¸Šçº¿, å¼€æ”¾äº¤æ˜“, perpetual, futures          â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ Case-insensitive matching                                 â”‚â”‚
â”‚  â”‚  â€¢ Regex pattern for symbol extraction                       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                      Match Found?                                â”‚
â”‚                              â”‚                                   â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚              â”‚ YES                           â”‚ NO               â”‚
â”‚              â–¼                               â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  CREATE RAW EVENT   â”‚          â”‚       SKIP          â”‚      â”‚
â”‚  â”‚                     â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”‚  source: twitter_   â”‚                                        â”‚
â”‚  â”‚    exchange_officialâ”‚                                        â”‚
â”‚  â”‚  twitter.tweet_id   â”‚                                        â”‚
â”‚  â”‚  twitter.username   â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                   PUSH TO REDIS                              â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  XADD events:raw * source twitter_exchange_official ...     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å½“å‰é™åˆ¶ä¸Žé—®é¢˜**:
- Twitter Free APIé™åˆ¶ä¸¥æ ¼ï¼Œæ¯15åˆ†é’Ÿä»…15æ¬¡è¯·æ±‚
- é¢‘ç¹å‡ºçŽ°HTTP 429 (Too Many Requests) é”™è¯¯
- å»ºè®®å‡çº§åˆ°Basicæˆ–Pro tierä»¥æå‡ç›‘æŽ§èƒ½åŠ›

---

### 2.3 é‡‡é›†é¢‘çŽ‡ä¸Žå¼‚æ­¥æž¶æž„

Node Bé‡‡ç”¨asyncioå¼‚æ­¥æž¶æž„ï¼ŒåŒæ—¶å¹¶å‘æ‰§è¡Œå¤šæ¡é“¾çš„ç›‘æŽ§ä»»åŠ¡ï¼Œé€šè¿‡åç¨‹è°ƒåº¦å®žçŽ°é«˜æ•ˆçš„èµ„æºåˆ©ç”¨ã€‚

**é‡‡é›†é¢‘çŽ‡é…ç½®**:

| æ•°æ®æº | è½®è¯¢é—´éš” | åŽŸå›  |
|--------|----------|------|
| Ethereum | 12ç§’ | ä¸ŽETHå‡ºå—æ—¶é—´åŒæ­¥ |
| BNB Chain | 10ç§’ | BSCå‡ºå—è¾ƒå¿« |
| Solana | 10ç§’ | é«˜TPSé“¾ |
| Arbitrum | 10ç§’ | L2å¿«é€Ÿç¡®è®¤ |
| Twitter | 60ç§’ | å—é™äºŽAPIé™æµ |

**å¼‚æ­¥æž¶æž„ç¤ºæ„**:

```python
async def main():
    """ä¸»äº‹ä»¶å¾ªçŽ¯"""
    tasks = [
        asyncio.create_task(eth_monitor()),      # ETHç›‘æŽ§åç¨‹
        asyncio.create_task(bnb_monitor()),      # BNBç›‘æŽ§åç¨‹
        asyncio.create_task(sol_monitor()),      # SOLç›‘æŽ§åç¨‹
        asyncio.create_task(arb_monitor()),      # ARBç›‘æŽ§åç¨‹
        asyncio.create_task(twitter_monitor()),  # Twitterç›‘æŽ§åç¨‹
        asyncio.create_task(heartbeat_sender()), # å¿ƒè·³å‘é€åç¨‹
    ]
    
    await asyncio.gather(*tasks, return_exceptions=True)
```

**èµ„æºä½¿ç”¨é…ç½®**:

```yaml
concurrency:
  max_rpc_connections: 20       # RPCè¿žæŽ¥æ± å¤§å°
  max_twitter_connections: 5    # Twitterè¿žæŽ¥æ•°
  semaphore_limit: 10           # å¹¶å‘ä¿¡å·é‡
  queue_size: 1000              # å†…éƒ¨é˜Ÿåˆ—å¤§å°
  
timeouts:
  rpc_request: 30               # RPCè¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰
  twitter_request: 15           # Twitterè¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰
```

---

### 2.4 å¿ƒè·³æœºåˆ¶

**å¿ƒè·³Key**: `node:heartbeat:NODE_B`

**å¿ƒè·³æ•°æ®ç»“æž„**:

```json
{
  "status": "running",
  "node_id": "NODE_B",
  "version": "v8.3.1",
  "uptime_seconds": 172800,
  "timestamp": 1764590430000,
  "stats": {
    "events_collected": 3421,
    "events_pushed": 3420,
    "errors": 156,
    "last_event_at": 1764590425000,
    "chains_active": {
      "ethereum": true,
      "bnb_chain": true,
      "solana": true,
      "arbitrum": true
    },
    "twitter_active": false,
    "twitter_rate_limited": true,
    "rpc_calls": {
      "ethereum": 12500,
      "bnb_chain": 15600,
      "solana": 14200,
      "arbitrum": 13800
    },
    "pairs_discovered": {
      "ethereum": 234,
      "bnb_chain": 567,
      "solana": 189,
      "arbitrum": 78
    }
  }
}
```

---

## 3. Node C - éŸ©å›½äº¤æ˜“æ‰€ + Telegram èŠ‚ç‚¹

Node Céƒ¨ç½²åœ¨éŸ©å›½é¦–å°”ï¼Œæ˜¯ç³»ç»Ÿæœ€å¤æ‚çš„é‡‡é›†èŠ‚ç‚¹ï¼ŒåŒæ—¶è´Ÿè´£éŸ©å›½äº¤æ˜“æ‰€REST APIç›‘æŽ§å’Œ51ä¸ªTelegramé¢‘é“çš„å®žæ—¶æ¶ˆæ¯é‡‡é›†ã€‚éŸ©å›½å¸‚åœºå› å…¶"æ³¡èœæº¢ä»·"æ•ˆåº”å…·æœ‰é‡è¦çš„ä¿¡å·ä»·å€¼ï¼Œè€ŒTelegramé¢‘é“ï¼ˆå°¤å…¶æ˜¯æ–¹ç¨‹å¼ç³»åˆ—ï¼‰æ˜¯èŽ·å–å†…å¹•æƒ…æŠ¥çš„æ ¸å¿ƒæ¸ é“ã€‚

### 3.1 éŸ©æ‰€è½®è¯¢é€»è¾‘

**éƒ¨ç½²ä¿¡æ¯**:

| å±žæ€§ | å€¼ |
|------|-----|
| æœåŠ¡å™¨IP | 158.247.222.198 |
| åœ°ç†ä½ç½® | ðŸ‡°ðŸ‡· éŸ©å›½é¦–å°” |
| æœåŠ¡å™¨è§„æ ¼ | 2vCPU / 4GB RAM |
| systemdæœåŠ¡ | collector_c.service, telegram_monitor.service |
| ä»£ç è·¯å¾„ | /root/v8.3_crypto_monitor/node_c/ |
| é…ç½®æ–‡ä»¶ | /root/v8.3_crypto_monitor/node_c/config.yaml |

**éŸ©å›½äº¤æ˜“æ‰€åˆ—è¡¨**:

| äº¤æ˜“æ‰€ | APIç«¯ç‚¹ | è½®è¯¢é—´éš” | å¸‚åœºåœ°ä½ | è¯„åˆ†æƒé‡ |
|--------|---------|----------|----------|----------|
| Upbit | https://api.upbit.com/v1/market/all | 5s | éŸ©å›½æœ€å¤§ | 1.35x |
| Bithumb | https://api.bithumb.com/public/ticker/ALL | 5s | ç¬¬äºŒå¤§ | 1.2x |
| Coinone | https://api.coinone.co.kr/public/v2/markets | 5s | ç¬¬ä¸‰å¤§ | 1.1x |
| Korbit | https://api.korbit.co.kr/v1/ticker/detailed | 5s | è€ç‰Œäº¤æ˜“æ‰€ | 1.0x |
| Gopax | https://api.gopax.co.kr/trading-pairs | 5s | æ–°å…´äº¤æ˜“æ‰€ | 0.95x |

**éŸ©æ‰€ç›‘æŽ§æµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  KOREAN EXCHANGE MONITORING                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    POLLING SCHEDULER                         â”‚â”‚
â”‚  â”‚                     (5s interval)                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚       â”‚                      â”‚                      â”‚           â”‚
â”‚       â–¼                      â–¼                      â–¼           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Upbit  â”‚           â”‚ Bithumb â”‚           â”‚ Coinone â”‚       â”‚
â”‚  â”‚         â”‚           â”‚         â”‚           â”‚         â”‚       â”‚
â”‚  â”‚ KRW-*   â”‚           â”‚ ALL_*   â”‚           â”‚ Markets â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚                     â”‚                     â”‚             â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                   RESPONSE PARSER                            â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ Extract trading pairs list                                â”‚â”‚
â”‚  â”‚  â€¢ Normalize symbol format (KRW-BTC â†’ BTC/KRW)               â”‚â”‚
â”‚  â”‚  â€¢ Filter by market (KRW, BTC, USDT)                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                   KNOWN PAIRS CHECK                          â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  Redis Set: known:pairs:upbit                                â”‚â”‚
â”‚  â”‚  Redis Set: known:pairs:bithumb                              â”‚â”‚
â”‚  â”‚  ...                                                         â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ SISMEMBER check for each symbol                           â”‚â”‚
â”‚  â”‚  â€¢ SADD for new symbols                                      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                    â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚   New Symbol?   â”‚                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                             â”‚                                    â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚ YES                         â”‚ NO                 â”‚
â”‚              â–¼                             â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  CREATE EVENT       â”‚       â”‚       SKIP          â”‚         â”‚
â”‚  â”‚                     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”‚  source: kr_market  â”‚                                        â”‚
â”‚  â”‚  exchange: upbit    â”‚                                        â”‚
â”‚  â”‚  symbol: KRW-NEW    â”‚                                        â”‚
â”‚  â”‚  event: listing     â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚             â”‚                                                    â”‚
â”‚             â–¼                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                   PUSH TO REDIS                              â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  XADD events:raw * source kr_market exchange upbit ...      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Upbit APIå“åº”ç¤ºä¾‹**:

```json
[
  {
    "market": "KRW-BTC",
    "korean_name": "ë¹„íŠ¸ì½”ì¸",
    "english_name": "Bitcoin"
  },
  {
    "market": "KRW-NEWTOKEN",
    "korean_name": "ë‰´í† í°",
    "english_name": "NewToken"
  }
]
```

---

### 3.2 51 ä¸ª Telegram é€šé“åˆ†ç±»

Node Cé€šè¿‡Telethonå®¢æˆ·ç«¯è®¢é˜…51ä¸ªé«˜ä»·å€¼Telegramé¢‘é“ï¼Œå®žæ—¶æ•èŽ·ä¸Šå¸æƒ…æŠ¥ã€å¸‚åœºé¢„è­¦å’Œäº¤æ˜“æ‰€å…¬å‘Šã€‚è¿™äº›é¢‘é“ç»è¿‡ç²¾å¿ƒç­›é€‰ï¼Œç¡®ä¿ä¿¡å·å¯†åº¦å’Œå¯ä¿¡åº¦ã€‚

**é¢‘é“åˆ†ç±»ä¸Žåˆ—è¡¨**:

**æ–¹ç¨‹å¼ç³»åˆ— (16ä¸ª) - Tier S**:

| é¢‘é“ | Username | ID | è¯´æ˜Ž | è¯„åˆ†æƒé‡ |
|------|----------|-----|------|----------|
| æ–¹ç¨‹å¼æ–°é—»ä¸»é¢‘é“ | @BWEnews | 1279597711 | å…¨ç½‘æœ€å¿«äº¤æ˜“æ‰€å†…å¹• | 60 |
| å¸å®‰å…¬å‘Šç›‘æŽ§ | @BWE_Binance_monitor | 2977082618 | Binanceä¸“é¡¹ç›‘æŽ§ | 58 |
| äºŒçº¿äº¤æ˜“æ‰€ç›‘æŽ§ | @BWE_tier2_monitor | 3006297937 | OKX/Bybit/Bitget | 55 |
| ä¸‰çº¿äº¤æ˜“æ‰€ç›‘æŽ§ | @BWE_tier3_monitor | 2580613515 | Gate/MEXCç­‰ | 52 |
| éŸ©æ‰€ç›‘æŽ§ | @BWE_korean_monitor | 2974857878 | éŸ©å›½äº¤æ˜“æ‰€ä¸“é¡¹ | 55 |
| ä»·æ ¼å¼‚åŠ¨ç›‘æµ‹ | @BWE_pricechange_monitor | 2963613944 | ä»·æ ¼é¢„è­¦ | 50 |
| OI&Priceå¼‚åŠ¨ | @BWE_OI_Price_monitor | 3096206759 | æŒä»“é‡å¼‚åŠ¨ | 52 |
| å¸å®‰Alpha&Moonshot | @BWE_reserved1 | 2758649849 | Alphaé¡¹ç›® | 58 |
| CZ&Heyiç›‘æŽ§ | @bwe_reserved4 | 2508537120 | æ ¸å¿ƒäººç‰©åŠ¨æ€ | 55 |
| AIç²¾é€‰èšåˆå™¨ | @BWE_media_monitor | 3042184220 | AIç­›é€‰æ–°é—» | 50 |
| æ–¹ç¨‹å¼è´¢ç» | @BWEtradfi | 2364176580 | ä¼ ç»Ÿé‡‘èžæ–°é—» | 45 |
| ç†è´¢æé†’ | @bwe_earn | 3164084756 | äº¤æ˜“æ‰€ç†è´¢ | 42 |
| æš‚æœªå¼€æ”¾3 | @BWE_reserved3 | 2996531644 | é¢„ç•™é¢‘é“ | 40 |
| æš‚æœªå¼€æ”¾6 | @BWE_Reserved6 | 3005315417 | é¢„ç•™é¢‘é“ | 40 |
| æš‚æœªå¼€æ”¾7 | @bwe_Reserved7 | 3168427228 | é¢„ç•™é¢‘é“ | 40 |
| æš‚æœªå¼€æ”¾8 | @bwe_reserved8 | 2927710852 | é¢„ç•™é¢‘é“ | 40 |

**äº¤æ˜“æ‰€å®˜æ–¹é¢‘é“ (8ä¸ª) - Tier A**:

| é¢‘é“ | Username | è¯´æ˜Ž | è¯„åˆ†æƒé‡ |
|------|----------|------|----------|
| Binanceå…¬å‘Š | @binance_announcements | å®˜æ–¹å…¬å‘Š | 58 |
| OKXå…¬å‘Š | @OKXAnnouncements | å®˜æ–¹å…¬å‘Š | 55 |
| Bybitå…¬å‘Š | @Bybit_Announcements | å®˜æ–¹å…¬å‘Š | 52 |
| Bitgetå…¬å‘Š | @Bitget_Announcements | å®˜æ–¹å…¬å‘Š | 50 |
| Bybit APIå…¬å‘Š | @Bybit_API_Announcements | APIå˜æ›´ | 48 |
| OKX Web3å…¬å‘Š | @okxwalletannouncement | Web3å…¬å‘Š | 45 |
| Bitget Walletå…¬å‘Š | @Bitget_Wallet_Announcement | é’±åŒ…å…¬å‘Š | 45 |
| Binance Moonbix | @Binance_Moonbix_Announcements | æ´»åŠ¨å…¬å‘Š | 42 |

**æ–°é—»åª’ä½“é¢‘é“ (6ä¸ª) - Tier A**:

| é¢‘é“ | Username | è¯´æ˜Ž | è¯„åˆ†æƒé‡ |
|------|----------|------|----------|
| å´è¯´åŒºå—é“¾ | @Wu_Blockchain | ä¸­æ–‡ä¸€æ‰‹ | 50 |
| PANews | @PANewsLab | å¿«è®¯å‡†ç¡® | 48 |
| Odaily | @OdailyChina | æ·±åº¦æŠ¥é“ | 45 |
| Foresight News | @foresightnews | å¿«é€Ÿå‡†ç¡® | 48 |
| åŒºå—å¾‹åŠ¨ | @blockbeats | å¿«è®¯åª’ä½“ | 45 |
| Binanceæ¸…ç®— | @BinanceLiquidations | æ¸…ç®—æ•°æ® | 42 |

**äºŒçº¿äº¤æ˜“æ‰€é¢‘é“ (12ä¸ª) - Tier B**:

| é¢‘é“ | Username | è¯„åˆ†æƒé‡ |
|------|----------|----------|
| BitMart | @BitMartExchange | 40 |
| BloFin | @BloFin_Official | 40 |
| WhiteBIT | @WhiteBIT | 38 |
| Phemex | @phemexofficial | 38 |
| Backpack | @BackpackExchange | 40 |
| BingX | @BingXOfficial | 38 |
| OKX Web3è‹±æ–‡ | @OKXWalletEN_Official | 42 |
| Binanceä¹Œå…‹å…° | @Binance_UA_official | 35 |
| Binanceä¿„è¯­ | @binance_ru | 35 |
| Bybitä¹Œå…‹å…° | @bybitukrainiannews | 35 |
| Bybitä¿„è¯­ | @BybitRussian | 35 |
| Blofinç¤¾åŒº | @blofin | 38 |

**å…¶ä»–æƒ…æŠ¥é¢‘é“ (9ä¸ª) - Tier B/C**:

| é¢‘é“ | Username | è¯„åˆ†æƒé‡ |
|------|----------|----------|
| Bing x | @BingX_Global | 38 |
| WhiteBITå®˜æ–¹ | @WhiteBIT_official | 35 |
| Phemex.com | @Phemex | 35 |
| OKX Racer | @okx_racer_official_announcement | 35 |
| Bybit SpaceS | @bybit_spaces_announcements | 35 |
| Crypto Gateway | @TheCryptoGateway | 32 |
| Gate.io | (å·²åŠ å…¥) | 40 |
| KuCoin News | (å·²åŠ å…¥) | 42 |
| MEXC English | (å·²åŠ å…¥) | 38 |

---

### 3.3 å…³é”®è¯åŒ¹é…æœºåˆ¶

Telegramç›‘æŽ§ä½¿ç”¨38ä¸ªç²¾å¿ƒè®¾è®¡çš„å…³é”®è¯è¿›è¡Œæ¶ˆæ¯è¿‡æ»¤ï¼Œåªæœ‰åŒ¹é…å…³é”®è¯çš„æ¶ˆæ¯æ‰ä¼šè¢«æŽ¨é€ä¸ºäº‹ä»¶ã€‚å…³é”®è¯è¦†ç›–è‹±æ–‡ã€ä¸­æ–‡å’ŒéŸ©æ–‡ï¼Œä»¥é€‚åº”ä¸åŒè¯­è¨€çš„é¢‘é“ã€‚

**å…³é”®è¯åˆ—è¡¨ (38ä¸ª)**:

```yaml
keywords:
  # è‹±æ–‡å…³é”®è¯ - ä¸Šå¸ç›¸å…³
  listing_en:
    - "listing"
    - "listed"
    - "will list"
    - "list"
    - "new token"
    - "launches"
    - "launched"
    - "trading open"
    - "deposit open"
    - "withdraw open"
    
  # è‹±æ–‡å…³é”®è¯ - åˆçº¦ç›¸å…³
  futures_en:
    - "perpetual"
    - "futures"
    - "perp"
    - "leverage"
    
  # è‹±æ–‡å…³é”®è¯ - å…¶ä»–
  other_en:
    - "airdrop"
    - "innovation zone"
    - "seed tag"
    - "alpha"
    
  # ä¸­æ–‡å…³é”®è¯
  chinese:
    - "ä¸Šå¸"
    - "ä¸Šçº¿"
    - "ä¸Šæ–°"
    - "å¼€æ”¾å……å€¼"
    - "å¼€æ”¾äº¤æ˜“"
    - "å¼€æ”¾æçŽ°"
    - "åˆçº¦"
    - "çŽ°è´§"
    - "æ æ†"
    - "æ°¸ç»­"
    - "ç©ºæŠ•"
    
  # éŸ©æ–‡å…³é”®è¯
  korean:
    - "ìƒìž¥"      # ä¸Šå¸‚
    - "ì‹ ê·œ"      # æ–°è§„
    - "ìž…ê¸ˆ"      # å……å€¼
    - "ì¶œê¸ˆ"      # æçŽ°
    - "ê±°ëž˜"      # äº¤æ˜“
```

**å…³é”®è¯åŒ¹é…é€»è¾‘**:

```python
def match_keywords(text: str, keywords: List[str]) -> List[str]:
    """
    åŒ¹é…æ¶ˆæ¯æ–‡æœ¬ä¸­çš„å…³é”®è¯
    
    Args:
        text: æ¶ˆæ¯åŽŸæ–‡
        keywords: å…³é”®è¯åˆ—è¡¨
        
    Returns:
        åŒ¹é…åˆ°çš„å…³é”®è¯åˆ—è¡¨
    """
    text_lower = text.lower()
    matched = []
    
    for keyword in keywords:
        # å¤§å°å†™ä¸æ•æ„ŸåŒ¹é…
        if keyword.lower() in text_lower:
            matched.append(keyword)
    
    return matched

def should_process_message(text: str, channel_category: str) -> Tuple[bool, List[str]]:
    """
    åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦åº”è¯¥å¤„ç†
    
    å¯¹äºŽæ–¹ç¨‹å¼ç­‰alpha_intelé¢‘é“ï¼Œæ‰€æœ‰æ¶ˆæ¯éƒ½å¤„ç†
    å¯¹äºŽæ™®é€šé¢‘é“ï¼Œéœ€è¦åŒ¹é…å…³é”®è¯
    """
    if channel_category == "alpha_intel":
        # æ–¹ç¨‹å¼ç³»åˆ—é¢‘é“ï¼šå…¨éƒ¨å¤„ç†
        return True, ["alpha_channel"]
    
    matched = match_keywords(text, ALL_KEYWORDS)
    return len(matched) > 0, matched
```

---

### 3.4 Telethon è®¢é˜…æ¨¡åž‹

Node Cä½¿ç”¨Telethonåº“å®žçŽ°Telegram MTProtoåè®®å®¢æˆ·ç«¯ï¼Œé€šè¿‡äº‹ä»¶å¤„ç†å™¨å®žæ—¶æŽ¥æ”¶å·²è®¢é˜…é¢‘é“çš„æ–°æ¶ˆæ¯ã€‚

**Telethoné…ç½®**:

```yaml
telethon:
  api_id: [configured]
  api_hash: [configured]
  session_name: "crypto_monitor"
  bot_token: "8581582698:AAH_TwtUGA5tfbIm6oawiDWyJLTDvJ6VLBQ"
  
  connection:
    timeout: 30
    retry_delay: 5
    max_retries: 10
    
  flood_wait:
    max_wait: 300         # æœ€é•¿ç­‰å¾…5åˆ†é’Ÿ
    auto_reconnect: true
```

**Telethonè®¢é˜…æž¶æž„**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TELEGRAM MONITOR                               â”‚
â”‚                   telegram_monitor.py                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                  TELETHON CLIENT                             â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ MTProto connection to Telegram DC                         â”‚â”‚
â”‚  â”‚  â€¢ Session persistence (crypto_monitor.session)              â”‚â”‚
â”‚  â”‚  â€¢ Auto-reconnect on disconnect                              â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                  CHANNEL RESOLVER                            â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ Load channels from channels_resolved.json                 â”‚â”‚
â”‚  â”‚  â€¢ Resolve username to entity (id, access_hash)              â”‚â”‚
â”‚  â”‚  â€¢ Cache resolved entities                                   â”‚â”‚
â”‚  â”‚  â€¢ 51 channels currently configured                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                  EVENT HANDLER                               â”‚â”‚
â”‚  â”‚                  @client.on(events.NewMessage)               â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  async def handle_new_message(event):                        â”‚â”‚
â”‚  â”‚      channel_id = event.chat_id                              â”‚â”‚
â”‚  â”‚      message_text = event.message.text                       â”‚â”‚
â”‚  â”‚      message_id = event.message.id                           â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚      # Check if from monitored channel                       â”‚â”‚
â”‚  â”‚      if channel_id not in monitored_ids:                     â”‚â”‚
â”‚  â”‚          return                                              â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚      # Keyword matching                                      â”‚â”‚
â”‚  â”‚      should_process, matched = should_process_message(...)   â”‚â”‚
â”‚  â”‚      if not should_process:                                  â”‚â”‚
â”‚  â”‚          return                                              â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚      # Create and push event                                 â”‚â”‚
â”‚  â”‚      await push_event(...)                                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                  SYMBOL EXTRACTOR                            â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  â€¢ Regex patterns for token symbols                          â”‚â”‚
â”‚  â”‚  â€¢ Exchange name detection                                   â”‚â”‚
â”‚  â”‚  â€¢ Trading pair extraction                                   â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  Patterns:                                                   â”‚â”‚
â”‚  â”‚  â€¢ [A-Z]{2,10}/USDT                                          â”‚â”‚
â”‚  â”‚  â€¢ will list ([A-Z]{2,10})                                   â”‚â”‚
â”‚  â”‚  â€¢ ä¸Šå¸ ([A-Z]{2,10})                                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                  REDIS PUBLISHER                             â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  source: tg_alpha_intel / tg_exchange_official /             â”‚â”‚
â”‚  â”‚          social_telegram                                     â”‚â”‚
â”‚  â”‚                                                              â”‚â”‚
â”‚  â”‚  telegram:                                                   â”‚â”‚
â”‚  â”‚    channel_id: 1279597711                                    â”‚â”‚
â”‚  â”‚    channel_username: "BWEnews"                               â”‚â”‚
â”‚  â”‚    message_id: 12345                                         â”‚â”‚
â”‚  â”‚    matched_keywords: ["will list", "binance"]                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶ˆæ¯å¤„ç†ä»£ç æ ¸å¿ƒé€»è¾‘**:

```python
@client.on(events.NewMessage(chats=monitored_channel_ids))
async def handle_new_message(event):
    """å¤„ç†æ–°æ¶ˆæ¯äº‹ä»¶"""
    try:
        channel_id = event.chat_id
        channel_info = channels_map.get(channel_id)
        
        if not channel_info:
            return
        
        message_text = event.message.text or ""
        if not message_text.strip():
            return
        
        # åˆ¤æ–­é¢‘é“ç±»åž‹å’Œå…³é”®è¯åŒ¹é…
        category = channel_info.get("category", "social_telegram")
        should_process, matched_keywords = should_process_message(
            message_text, category
        )
        
        if not should_process:
            stats["messages_received"] += 1
            return
        
        # æå–symbol
        symbols = extract_symbols(message_text)
        exchange = detect_exchange(message_text)
        
        # ç¡®å®šsourceç±»åž‹
        if category == "alpha_intel":
            source = "tg_alpha_intel"
        elif category == "exchange_official":
            source = "tg_exchange_official"
        else:
            source = "social_telegram"
        
        # æž„å»ºäº‹ä»¶
        raw_event = {
            "source": source,
            "source_type": "social",
            "exchange": exchange,
            "symbol": symbols[0] if symbols else None,
            "event": "listing",
            "raw_text": message_text[:2000],  # æˆªæ–­è¿‡é•¿æ–‡æœ¬
            "url": f"https://t.me/{channel_info['username']}/{event.message.id}",
            "detected_at": int(time.time() * 1000),
            "node_id": "NODE_C",
            "telegram": {
                "channel_id": channel_id,
                "channel_username": channel_info.get("username", ""),
                "channel_title": channel_info.get("title", ""),
                "message_id": event.message.id,
                "matched_keywords": matched_keywords,
                "forward_from": None,
                "reply_to": None
            }
        }
        
        # æŽ¨é€åˆ°Redis
        await redis_client.xadd("events:raw", raw_event)
        
        stats["events_matched"] += 1
        stats["events_pushed"] += 1
        logger.info(f"ðŸ“© [{channel_info['title']}] åŒ¹é…å…³é”®è¯: {matched_keywords}")
        
    except Exception as e:
        stats["errors"] += 1
        logger.error(f"å¤„ç†æ¶ˆæ¯å¤±è´¥: {e}")
```

---

### 3.5 å¿ƒè·³æœºåˆ¶

Node Cæœ‰ä¸¤ä¸ªç‹¬ç«‹çš„å¿ƒè·³ï¼šä¸€ä¸ªæ¥è‡ªcollector_c.pyï¼ˆéŸ©æ‰€ç›‘æŽ§ï¼‰ï¼Œä¸€ä¸ªæ¥è‡ªtelegram_monitor.pyï¼ˆTelegramç›‘æŽ§ï¼‰ã€‚

**éŸ©æ‰€å¿ƒè·³Key**: `node:heartbeat:NODE_C`

```json
{
  "status": "running",
  "node_id": "NODE_C",
  "version": "v8.3.1",
  "uptime_seconds": 86400,
  "timestamp": 1764590430000,
  "stats": {
    "events_collected": 567,
    "events_pushed": 565,
    "errors": 2,
    "last_event_at": 1764590425000,
    "exchanges_active": {
      "upbit": true,
      "bithumb": true,
      "coinone": true,
      "korbit": true,
      "gopax": true
    },
    "rest_calls": 17280,
    "symbols_known": {
      "upbit": 234,
      "bithumb": 189,
      "coinone": 156,
      "korbit": 78,
      "gopax": 45
    }
  }
}
```

**Telegramå¿ƒè·³Key**: `node:heartbeat:NODE_C_TELEGRAM`

```json
{
  "status": "running",
  "node_id": "NODE_C_TELEGRAM",
  "version": "v8.3.1",
  "uptime_seconds": 43200,
  "timestamp": 1764590430000,
  "channels": 51,
  "stats": {
    "messages_received": 28456,
    "events_matched": 342,
    "events_pushed": 340,
    "errors": 2,
    "last_message_at": 1764590425000,
    "channels_active": 51,
    "channels_error": 0,
    "keywords_matched": {
      "listing": 156,
      "will list": 89,
      "ä¸Šå¸": 45,
      "trading open": 32,
      "deposit open": 20
    }
  }
}
```

---

## 4. Redis Server - Fusion Center

Redis Serveræ˜¯ç³»ç»Ÿçš„ä¸­å¿ƒæž¢çº½ï¼Œéƒ¨ç½²åœ¨æ–°åŠ å¡ï¼Œè´Ÿè´£æŽ¥æ”¶æ‰€æœ‰é‡‡é›†èŠ‚ç‚¹çš„äº‹ä»¶ã€æ‰§è¡Œä¿¡å·èžåˆã€è¯„åˆ†å’Œè·¯ç”±ã€‚è¯¥æœåŠ¡å™¨è¿è¡Œå¤šä¸ªæ ¸å¿ƒæœåŠ¡ï¼Œæ˜¯æ•´ä¸ªç³»ç»Ÿçš„"å¤§è„‘"ã€‚

### 4.1 Event Streams åˆ—è¡¨

Redis Streamsæ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒæ¶ˆæ¯ä¼ è¾“æœºåˆ¶ï¼Œæ¯ä¸ªStreamæ‰¿æ‹…ç‰¹å®šçš„æ•°æ®æµè½¬èŒè´£ã€‚

**éƒ¨ç½²ä¿¡æ¯**:

| å±žæ€§ | å€¼ |
|------|-----|
| æœåŠ¡å™¨IP | 139.180.133.81 |
| åœ°ç†ä½ç½® | ðŸ‡¸ðŸ‡¬ æ–°åŠ å¡ |
| æœåŠ¡å™¨è§„æ ¼ | 2vCPU / 4GB RAM |
| Redisç‰ˆæœ¬ | 7.0+ |
| Redisç«¯å£ | 6379 |
| Rediså¯†ç  | OiONEfYjv9qKxLrsrLe8b0Q+5Ik2fjibxmH6zAuZqhE= |

**Streamå®šä¹‰**:

| Stream | ç”¨é€” | maxlen | ç”Ÿäº§è€… | æ¶ˆè´¹è€… |
|--------|------|--------|--------|--------|
| `events:raw` | åŽŸå§‹äº‹ä»¶å…¥å£ | 50,000 | Node A/B/C | Fusion Engine |
| `events:fused` | èžåˆåŽäº‹ä»¶ | 10,000 | Fusion Engine | Signal Router |
| `events:route:cex` | CEXæ‰§è¡Œè·¯ç”± | 10,000 | Signal Router | CEX Executor |
| `events:route:hl` | Hyperliquidè·¯ç”± | 10,000 | Signal Router | HL Executor |
| `events:route:dex` | DEXæ‰§è¡Œè·¯ç”± | 10,000 | Signal Router | DEX Executor |
| `events:executed` | å·²æ‰§è¡Œäº¤æ˜“ | 50,000 | All Executors | Dashboard |

**Streamæ•°æ®æµå‘**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     REDIS STREAMS TOPOLOGY                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Node A   â”‚  â”‚  Node B   â”‚  â”‚  Node C   â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚        â”‚              â”‚              â”‚                          â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚        â”‚        events:raw            â”‚  maxlen=50,000          â”‚
â”‚        â”‚   (åŽŸå§‹äº‹ä»¶ ~1000/min)       â”‚                         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚        â”‚      Fusion Engine           â”‚                         â”‚
â”‚        â”‚  â€¢ è´å¶æ–¯è¯„åˆ†                â”‚                         â”‚
â”‚        â”‚  â€¢ å¤šæºèšåˆ                  â”‚                         â”‚
â”‚        â”‚  â€¢ åŽ»é‡è¿‡æ»¤                  â”‚                         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚        â”‚       events:fused           â”‚  maxlen=10,000          â”‚
â”‚        â”‚   (èžåˆäº‹ä»¶ ~50/hour)        â”‚                         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚        â”‚      Signal Router           â”‚                         â”‚
â”‚        â”‚  â€¢ è¯„åˆ†é˜ˆå€¼åˆ¤æ–­              â”‚                         â”‚
â”‚        â”‚  â€¢ äº¤æ˜“æ‰€å¯ç”¨æ€§æ£€æŸ¥          â”‚                         â”‚
â”‚        â”‚  â€¢ è·¯ç”±å†³ç­–                  â”‚                         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                       â”‚                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚        â”‚              â”‚              â”‚                          â”‚
â”‚        â–¼              â–¼              â–¼                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚route:cex  â”‚  â”‚ route:hl  â”‚  â”‚ route:dex â”‚                   â”‚
â”‚  â”‚ (Gate/    â”‚  â”‚(Hyper-    â”‚  â”‚ (DEX      â”‚                   â”‚
â”‚  â”‚  MEXC)    â”‚  â”‚ liquid)   â”‚  â”‚  æœªå¯ç”¨)  â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚        â”‚              â”‚                                          â”‚
â”‚        â–¼              â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚CEX        â”‚  â”‚HL         â”‚                                   â”‚
â”‚  â”‚Executor   â”‚  â”‚Executor   â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚        â”‚              â”‚                                          â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â–¼                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚        â”‚      events:executed         â”‚  maxlen=50,000          â”‚
â”‚        â”‚   (äº¤æ˜“è®°å½• ~10/day)         â”‚                         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4.2 Consumer Groups

Consumer Groupsç¡®ä¿äº‹ä»¶è¢«å¯é åœ°æ¶ˆè´¹ä¸”ä¸ä¼šä¸¢å¤±ï¼Œæ”¯æŒå¤šæ¶ˆè´¹è€…å¹¶è¡Œå¤„ç†å’Œæ•…éšœæ¢å¤ã€‚

**Consumer Groupé…ç½®**:

| Groupåç§° | Stream | Consumer | ç”¨é€” |
|-----------|--------|----------|------|
| `fusion_engine_group` | events:raw | fusion_1 | Fusion Engineæ¶ˆè´¹åŽŸå§‹äº‹ä»¶ |
| `signal_router_group` | events:fused | router_1 | Signal Routeræ¶ˆè´¹èžåˆäº‹ä»¶ |
| `cex_executor` | events:route:cex | executor_1 | CEX Executoræ¶ˆè´¹CEXè·¯ç”± |
| `hl_executor` | events:route:hl | hl_exec_1 | HL Executoræ¶ˆè´¹HLè·¯ç”± |

**Consumer Groupç®¡ç†å‘½ä»¤**:

```bash
# åˆ›å»ºConsumer Group
redis-cli -a 'PASSWORD' XGROUP CREATE events:raw fusion_engine_group $ MKSTREAM

# æŸ¥çœ‹Consumer Groupä¿¡æ¯
redis-cli -a 'PASSWORD' XINFO GROUPS events:raw

# æŸ¥çœ‹pendingæ¶ˆæ¯
redis-cli -a 'PASSWORD' XPENDING events:raw fusion_engine_group

# æŸ¥çœ‹æ¶ˆè´¹è€…å»¶è¿Ÿ
redis-cli -a 'PASSWORD' XINFO GROUPS events:raw
# è¾“å‡ºä¸­çš„ "lag" å­—æ®µè¡¨ç¤ºæœªæ¶ˆè´¹æ¶ˆæ¯æ•°
```

**æ¶ˆè´¹è€…ä»£ç æ¨¡å¼**:

```python
async def consume_events(self):
    """ä½¿ç”¨Consumer Groupæ¶ˆè´¹äº‹ä»¶"""
    stream_name = "events:raw"
    group_name = "fusion_engine_group"
    consumer_name = "fusion_1"
    
    while True:
        try:
            # ä»ŽConsumer Groupè¯»å–äº‹ä»¶
            results = self.redis.xreadgroup(
                groupname=group_name,
                consumername=consumer_name,
                streams={stream_name: ">"},  # ">" è¡¨ç¤ºåªè¯»å–æ–°æ¶ˆæ¯
                count=100,                   # æ‰¹é‡è¯»å–
                block=5000                   # é˜»å¡ž5ç§’
            )
            
            for stream, messages in results:
                for message_id, data in messages:
                    try:
                        # å¤„ç†æ¶ˆæ¯
                        await self.process_event(data)
                        
                        # ç¡®è®¤æ¶ˆæ¯
                        self.redis.xack(stream_name, group_name, message_id)
                        
                    except Exception as e:
                        logger.error(f"å¤„ç†æ¶ˆæ¯å¤±è´¥: {e}")
                        # ä¸ç¡®è®¤ï¼Œæ¶ˆæ¯å°†é‡æ–°æŠ•é€’
                        
        except Exception as e:
            logger.error(f"æ¶ˆè´¹å¾ªçŽ¯å¼‚å¸¸: {e}")
            await asyncio.sleep(5)
```

---

### 4.3 åŽ»é‡ã€è¿‡æœŸã€åŽ‹ç¼©æœºåˆ¶

Redis Serverå®žçŽ°å¤šå±‚æ•°æ®ç®¡ç†æœºåˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿé«˜æ•ˆè¿è¡Œå¹¶æŽ§åˆ¶å­˜å‚¨å ç”¨ã€‚

**åŽ»é‡æœºåˆ¶**:

```python
# äº‹ä»¶åŽ»é‡ï¼šåŸºäºŽå†…å®¹å“ˆå¸Œ
def get_event_hash(event: dict) -> str:
    """ç”Ÿæˆäº‹ä»¶å“ˆå¸Œç”¨äºŽåŽ»é‡"""
    key_fields = [
        event.get("exchange", ""),
        event.get("symbol", ""),
        event.get("event", ""),
        event.get("source", "")
    ]
    content = "|".join(str(f) for f in key_fields)
    return hashlib.md5(content.encode()).hexdigest()[:16]

# åŽ»é‡æ£€æŸ¥
def is_duplicate(event_hash: str, window_seconds: int = 300) -> bool:
    """æ£€æŸ¥äº‹ä»¶æ˜¯å¦åœ¨5åˆ†é’Ÿå†…å·²å¤„ç†"""
    key = f"dedup:{event_hash}"
    exists = redis.exists(key)
    if not exists:
        redis.setex(key, window_seconds, "1")
    return exists
```

**è¿‡æœŸç­–ç•¥**:

| æ•°æ®ç±»åž‹ | Keyæ¨¡å¼ | TTL | è¯´æ˜Ž |
|----------|---------|-----|------|
| å¿ƒè·³æ•°æ® | `node:heartbeat:*` | 120ç§’ | 2åˆ†é’Ÿæ— æ›´æ–°è§†ä¸ºç¦»çº¿ |
| åŽ»é‡è®°å½• | `dedup:*` | 300ç§’ | 5åˆ†é’ŸåŽ»é‡çª—å£ |
| å·²çŸ¥äº¤æ˜“å¯¹ | `known:pairs:*` | 86400ç§’ | 24å°æ—¶åˆ·æ–° |
| å†·å´è®°å½• | `cooldown:*` | 30ç§’ | åŒå¸ç§äº¤æ˜“å†·å´ |
| äº¤æ˜“æ‰€é”å®š | `lock:exchange:*` | 3600ç§’ | äº¤æ˜“æ‰€1å°æ—¶é”å®š |

**StreamåŽ‹ç¼©ï¼ˆXTRIMï¼‰**:

```yaml
# é€šè¿‡maxlenè‡ªåŠ¨åŽ‹ç¼©
streams:
  events:raw:
    maxlen: 50000      # ä¿ç•™æœ€æ–°5ä¸‡æ¡
    approximate: true  # è¿‘ä¼¼è£å‰ªï¼ˆæ€§èƒ½æ›´å¥½ï¼‰
    
  events:fused:
    maxlen: 10000
    approximate: true
    
  events:executed:
    maxlen: 50000
    approximate: true
```

**å®šæ—¶æ¸…ç†ä»»åŠ¡**:

```cron
# /var/spool/cron/crontabs/root

# æ¯å°æ—¶æ¸…ç†è¿‡æœŸæ•°æ®
0 * * * * /opt/redis/cleanup.sh >> /var/log/redis-cleanup.log 2>&1

# æ¯æ—¥å‡Œæ™¨3ç‚¹å¤‡ä»½
0 3 * * * /root/v8.3_crypto_monitor/redis_server/backup.sh >> /root/v8.3_crypto_monitor/backups/backup.log 2>&1
```

**cleanup.shè„šæœ¬**:

```bash
#!/bin/bash
# Redisæ¸…ç†è„šæœ¬

REDIS_CLI="redis-cli -a 'OiONEfYjv9qKxLrsrLe8b0Q+5Ik2fjibxmH6zAuZqhE=' --no-auth-warning"

# æ¸…ç†è¿‡æœŸåŽ»é‡è®°å½•ï¼ˆå·²é€šè¿‡TTLè‡ªåŠ¨è¿‡æœŸï¼Œè¿™é‡Œåšé¢å¤–æ¸…ç†ï¼‰
echo "[$(date)] å¼€å§‹æ¸…ç†..."

# Streamè£å‰ªï¼ˆç¡®ä¿ä¸è¶…è¿‡maxlenï¼‰
$REDIS_CLI XTRIM events:raw MAXLEN ~ 50000
$REDIS_CLI XTRIM events:fused MAXLEN ~ 10000
$REDIS_CLI XTRIM events:executed MAXLEN ~ 50000

# å†…å­˜ä½¿ç”¨æŠ¥å‘Š
$REDIS_CLI INFO memory | grep used_memory_human

echo "[$(date)] æ¸…ç†å®Œæˆ"
```

---

## 5. æœåŠ¡éƒ¨ç½²ç»“æž„ï¼ˆsystemdï¼‰

æ‰€æœ‰é‡‡é›†èŠ‚ç‚¹å’Œæ ¸å¿ƒæœåŠ¡å‡é€šè¿‡systemdè¿›è¡Œç®¡ç†ï¼Œç¡®ä¿å¼€æœºè‡ªå¯ã€å¼‚å¸¸é‡å¯å’Œæ—¥å¿—é›†ä¸­ç®¡ç†ã€‚

**æœåŠ¡æ¸…å•**:

| æœåŠ¡å™¨ | æœåŠ¡å | æœåŠ¡æ–‡ä»¶ | è¯´æ˜Ž |
|--------|--------|----------|------|
| Node A | collector_a | /etc/systemd/system/collector_a.service | äº¤æ˜“æ‰€é‡‡é›†å™¨ |
| Node B | collector_b | /etc/systemd/system/collector_b.service | é“¾ä¸Š+Twitteré‡‡é›†å™¨ |
| Node C | collector_c | /etc/systemd/system/collector_c.service | éŸ©æ‰€é‡‡é›†å™¨ |
| Node C | telegram_monitor | /etc/systemd/system/telegram_monitor.service | Telegramç›‘æŽ§ |
| Redis | redis-server | ç³»ç»ŸæœåŠ¡ | Redisæ•°æ®åº“ |
| Redis | fusion_engine | /etc/systemd/system/fusion_engine.service | èžåˆå¼•æ“Ž |
| Redis | signal_router | /etc/systemd/system/signal_router.service | ä¿¡å·è·¯ç”± |
| Redis | webhook_pusher | /etc/systemd/system/webhook_pusher.service | WebhookæŽ¨é€ |
| Redis | cex_executor | /etc/systemd/system/cex_executor.service | CEXæ‰§è¡Œå™¨ |
| Redis | dashboard | /etc/systemd/system/dashboard.service | ç›‘æŽ§é¢æ¿ |
| Redis | alert_monitor | /etc/systemd/system/alert_monitor.service | å‘Šè­¦ç›‘æŽ§ |

**é€šç”¨æœåŠ¡é…ç½®æ¨¡æ¿**:

```ini
# /etc/systemd/system/collector_a.service

[Unit]
Description=Crypto Monitor Node A - Exchange Collector
After=network.target
Wants=network-online.target

[Service]
Type=simple
User=root
Group=root
WorkingDirectory=/root/v8.3_crypto_monitor/node_a
ExecStart=/usr/bin/python3 collector_a.py
Restart=always
RestartSec=5
StartLimitBurst=10
StartLimitIntervalSec=60

# çŽ¯å¢ƒå˜é‡
Environment=PYTHONUNBUFFERED=1
Environment=PYTHONPATH=/root/v8.3_crypto_monitor/shared

# æ—¥å¿—
StandardOutput=journal
StandardError=journal
SyslogIdentifier=collector_a

# èµ„æºé™åˆ¶
MemoryMax=2G
CPUQuota=150%

[Install]
WantedBy=multi-user.target
```

**Fusion EngineæœåŠ¡é…ç½®**:

```ini
# /etc/systemd/system/fusion_engine.service

[Unit]
Description=Crypto Monitor Fusion Engine
After=network.target redis-server.service
Requires=redis-server.service

[Service]
Type=simple
User=root
WorkingDirectory=/root/v8.3_crypto_monitor/redis_server
ExecStart=/usr/bin/python3 fusion_engine.py
Restart=always
RestartSec=5
Environment=PYTHONUNBUFFERED=1

[Install]
WantedBy=multi-user.target
```

**Telegram MonitoræœåŠ¡é…ç½®**:

```ini
# /etc/systemd/system/telegram_monitor.service

[Unit]
Description=Crypto Monitor Telegram Channel Monitor
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/v8.3_crypto_monitor/node_c
ExecStart=/usr/bin/python3 telegram_monitor.py
Restart=always
RestartSec=10
Environment=PYTHONUNBUFFERED=1

# Telegramè¿žæŽ¥å¯èƒ½éœ€è¦æ›´é•¿å¯åŠ¨æ—¶é—´
TimeoutStartSec=120

[Install]
WantedBy=multi-user.target
```

**DashboardæœåŠ¡é…ç½®**:

```ini
# /etc/systemd/system/dashboard.service

[Unit]
Description=Crypto Monitor Dashboard
After=network.target redis-server.service

[Service]
Type=simple
User=root
WorkingDirectory=/root/v8.3_crypto_monitor/dashboard
ExecStart=/usr/local/bin/gunicorn -w 2 -b 0.0.0.0:5001 app:app
Restart=always
RestartSec=5
Environment=REDIS_HOST=127.0.0.1
Environment=REDIS_PORT=6379
Environment=REDIS_PASSWORD=OiONEfYjv9qKxLrsrLe8b0Q+5Ik2fjibxmH6zAuZqhE=

[Install]
WantedBy=multi-user.target
```

**æœåŠ¡ç®¡ç†å‘½ä»¤**:

```bash
# å¯åŠ¨æœåŠ¡
systemctl start fusion_engine

# åœæ­¢æœåŠ¡
systemctl stop fusion_engine

# é‡å¯æœåŠ¡
systemctl restart fusion_engine

# æŸ¥çœ‹çŠ¶æ€
systemctl status fusion_engine

# è®¾ç½®å¼€æœºè‡ªå¯
systemctl enable fusion_engine

# æŸ¥çœ‹æ—¥å¿—
journalctl -u fusion_engine -f
journalctl -u fusion_engine --no-pager -n 100

# é‡æ–°åŠ è½½systemdé…ç½®
systemctl daemon-reload
```

**æ‰¹é‡æœåŠ¡ç®¡ç†è„šæœ¬**:

```bash
#!/bin/bash
# /root/v8.3_crypto_monitor/manage_services.sh

ACTION=$1

case $ACTION in
  start)
    echo "å¯åŠ¨æ‰€æœ‰æœåŠ¡..."
    systemctl start redis-server
    systemctl start fusion_engine
    systemctl start signal_router
    systemctl start webhook_pusher
    systemctl start cex_executor
    systemctl start dashboard
    systemctl start alert_monitor
    ;;
    
  stop)
    echo "åœæ­¢æ‰€æœ‰æœåŠ¡..."
    systemctl stop alert_monitor
    systemctl stop dashboard
    systemctl stop cex_executor
    systemctl stop webhook_pusher
    systemctl stop signal_router
    systemctl stop fusion_engine
    # Redisæœ€åŽåœæ­¢
    ;;
    
  status)
    echo "=== æœåŠ¡çŠ¶æ€ ==="
    for svc in redis-server fusion_engine signal_router webhook_pusher cex_executor dashboard alert_monitor; do
      status=$(systemctl is-active $svc)
      echo "$svc: $status"
    done
    ;;
    
  restart)
    $0 stop
    sleep 3
    $0 start
    ;;
    
  *)
    echo "ç”¨æ³•: $0 {start|stop|status|restart}"
    exit 1
    ;;
esac
```

---

## é™„å½•A: èŠ‚ç‚¹é—´é€šä¿¡çŸ©é˜µ

| æº | ç›®æ ‡ | åè®® | ç«¯å£ | ç”¨é€” |
|----|------|------|------|------|
| Node A | Redis Server | TCP | 6379 | äº‹ä»¶æŽ¨é€ã€å¿ƒè·³ |
| Node B | Redis Server | TCP | 6379 | äº‹ä»¶æŽ¨é€ã€å¿ƒè·³ |
| Node C | Redis Server | TCP | 6379 | äº‹ä»¶æŽ¨é€ã€å¿ƒè·³ |
| Redis Server | n8n Cloud | HTTPS | 443 | WebhookæŽ¨é€ |
| Fusion Engine | CEX APIs | HTTPS | 443 | äº¤æ˜“æ‰§è¡Œ |
| ç”¨æˆ· | Redis Server | HTTP | 5000/5001 | Dashboardè®¿é—® |

---

## é™„å½•B: èŠ‚ç‚¹å¥åº·æ£€æŸ¥è„šæœ¬

```bash
#!/bin/bash
# /root/v8.3_crypto_monitor/check_nodes.sh

REDIS_CLI="redis-cli -h 139.180.133.81 -a 'OiONEfYjv9qKxLrsrLe8b0Q+5Ik2fjibxmH6zAuZqhE=' --no-auth-warning"

echo "=== èŠ‚ç‚¹å¥åº·æ£€æŸ¥ ==="
echo ""

for node in NODE_A NODE_B NODE_C NODE_C_TELEGRAM FUSION; do
  timestamp=$($REDIS_CLI HGET "node:heartbeat:$node" timestamp)
  status=$($REDIS_CLI HGET "node:heartbeat:$node" status)
  
  if [ -z "$timestamp" ]; then
    echo "âŒ $node: æ— å¿ƒè·³æ•°æ®"
  else
    now=$(date +%s%3N)
    age=$(( (now - timestamp) / 1000 ))
    
    if [ $age -gt 90 ]; then
      echo "âš ï¸ $node: å¿ƒè·³å»¶è¿Ÿ ${age}s (status: $status)"
    else
      echo "âœ… $node: æ­£å¸¸ (${age}s ago, status: $status)"
    fi
  fi
done

echo ""
echo "=== é˜Ÿåˆ—çŠ¶æ€ ==="
echo "events:raw: $($REDIS_CLI XLEN events:raw)"
echo "events:fused: $($REDIS_CLI XLEN events:fused)"
echo "events:executed: $($REDIS_CLI XLEN events:executed)"
```

---

## é™„å½•C: ç‰ˆæœ¬åŽ†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|------|------|----------|
| v7.x | 2025-10 | 6å°Chromeçˆ¬è™«æž¶æž„ï¼ˆå·²åºŸå¼ƒï¼‰ |
| v8.0 | 2025-11 | WebSocket+RESTé‡æž„ |
| v8.3 | 2025-11 | 3èŠ‚ç‚¹åˆ†å¸ƒå¼æž¶æž„ |
| v8.3.1 | 2025-12 | Redisè¿ç§»è‡³æ–°åŠ å¡ï¼Œæ–‡æ¡£æ›´æ–° |

---

**æ–‡æ¡£ç»“æŸ**

*æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†Multi-Source Crypto Listing Automation Systemçš„èŠ‚ç‚¹æž¶æž„ã€‚æ‰€æœ‰é…ç½®å’Œä»£ç ç¤ºä¾‹å‡åŸºäºŽå®žé™…è¿è¡Œç³»ç»Ÿï¼Œå¯ç›´æŽ¥ç”¨äºŽå¼€å‘ã€è¿ç»´å’Œæ•…éšœæŽ’æŸ¥ã€‚*
