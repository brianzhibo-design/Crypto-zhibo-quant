# n8n å†³ç­–æµè¯´æ˜ï¼ˆDecision Flowï¼‰

**æ–‡æ¡£ç‰ˆæœ¬**: v8.3.1  
**æœ€åæ›´æ–°**: 2025å¹´12æœˆ3æ—¥  
**é€‚ç”¨ç³»ç»Ÿ**: Crypto AutoTrader HL - Automated Signal Detection and Hyperliquid Trading  
**å·¥ä½œæµID**: OxBbo37Vsq8kzYiC  
**ç»´æŠ¤è€…**: Brian  

---

## æ¦‚è¿°

n8nå†³ç­–æµæ˜¯ç³»ç»Ÿçš„æ™ºèƒ½ä¸­æ¢ï¼Œè´Ÿè´£æ¥æ”¶Fusion Engineæ¨é€çš„èåˆä¿¡å·ï¼Œé€šè¿‡AIåˆ†æéªŒè¯ä¿¡å·çœŸå®æ€§ï¼Œæ‰§è¡Œå¤šå±‚è¿‡æ»¤å’Œé£æ§æ£€æŸ¥ï¼Œæœ€ç»ˆç”Ÿæˆäº¤æ˜“ç­–ç•¥å¹¶åœ¨Hyperliquidä¸Šæ‰§è¡Œã€‚æ•´ä¸ªæµç¨‹è®¾è®¡ä¸ºä½å»¶è¿Ÿã€é«˜å¯é ï¼Œä»ä¿¡å·æ¥æ”¶åˆ°äº¤æ˜“æ‰§è¡Œçš„ç«¯åˆ°ç«¯å»¶è¿Ÿæ§åˆ¶åœ¨5ç§’ä»¥å†…ã€‚

**å·¥ä½œæµæ¶æ„æ€»è§ˆ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        n8n DECISION FLOW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚  â”‚ Webhook Trigger â”‚    â”‚ Telegram Triggerâ”‚                                 â”‚
â”‚  â”‚ POST /crypto-   â”‚    â”‚ (Bot Messages)  â”‚                                 â”‚
â”‚  â”‚     signal      â”‚    â”‚                 â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚           â”‚                      â”‚                                          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                      â”‚                                                       â”‚
â”‚                      â–¼                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚  Normalize Event    â”‚                                           â”‚
â”‚           â”‚  (æ ¼å¼æ ‡å‡†åŒ–)       â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚                                                       â”‚
â”‚                      â–¼                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚  Generate Content   â”‚                                           â”‚
â”‚           â”‚  Hash (SHA256å»é‡)  â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚                                                       â”‚
â”‚                      â–¼                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚  Redis Dedup Check  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚           â”‚  (SET NX + TTL)     â”‚          â”‚                                â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                                â”‚
â”‚                      â”‚                     â”‚ Redis                          â”‚
â”‚                      â–¼                     â”‚ 139.180.133.81                 â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                                â”‚
â”‚           â”‚  Filter Duplicates  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚           â”‚  (is_duplicate?)    â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚ (éé‡å¤)                                             â”‚
â”‚                      â–¼                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚  Bayesian Fast      â”‚                                           â”‚
â”‚           â”‚  Track (è¯„åˆ†åˆ¤æ–­)   â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚                     â”‚                                           â”‚
â”‚      é«˜åˆ†å¿«é€Ÿé€šé“          ä½åˆ†AIåˆ†æ                                       â”‚
â”‚           â”‚                     â”‚                                           â”‚
â”‚           â”‚                     â–¼                                           â”‚
â”‚           â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚           â”‚          â”‚  Listing Event      â”‚                                â”‚
â”‚           â”‚          â”‚  Analyzer (AI)      â”‚                                â”‚
â”‚           â”‚          â”‚  GPT-4o-mini        â”‚                                â”‚
â”‚           â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚           â”‚                     â”‚                                           â”‚
â”‚           â”‚                     â–¼                                           â”‚
â”‚           â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚           â”‚          â”‚  Filter High        â”‚                                â”‚
â”‚           â”‚          â”‚  Quality Signals    â”‚                                â”‚
â”‚           â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚           â”‚                     â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚                                                       â”‚
â”‚                      â–¼                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚  Strategy Generator â”‚                                           â”‚
â”‚           â”‚  (HL) - ä»“ä½è®¡ç®—    â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚                                                       â”‚
â”‚                      â–¼                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚  Prepare Trade      â”‚                                           â”‚
â”‚           â”‚  Config (é£æ§æ ¡éªŒ)  â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚                                                       â”‚
â”‚                      â–¼                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚  Execute Trade via  â”‚                                           â”‚
â”‚           â”‚  HTTP (Hyperliquid) â”‚                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                      â”‚                                                       â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚           â”‚                     â”‚                                           â”‚
â”‚        æˆåŠŸ                   å¤±è´¥                                          â”‚
â”‚           â”‚                     â”‚                                           â”‚
â”‚           â–¼                     â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚ Build Trade Logâ”‚   â”‚ Log Failed     â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ Trade          â”‚                                   â”‚
â”‚          â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                     â”‚                                                       â”‚
â”‚                     â–¼                                                       â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚          â”‚ Prepare WeChat      â”‚                                           â”‚
â”‚          â”‚ Message (é€šçŸ¥)      â”‚                                           â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                     â”‚                                                       â”‚
â”‚                     â–¼                                                       â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚          â”‚ Send to WeChat      â”‚                                           â”‚
â”‚          â”‚ (ä¼ä¸šå¾®ä¿¡Webhook)   â”‚                                           â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                     â”‚                                                       â”‚
â”‚                     â–¼                                                       â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚          â”‚ Trigger Position    â”‚                                           â”‚
â”‚          â”‚ Monitor (TP/SL)     â”‚                                           â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Webhook è¾“å…¥æ ¼å¼

n8nå·¥ä½œæµæ”¯æŒä¸¤ç§è¾“å…¥æ¸ é“ï¼šHTTP Webhookå’ŒTelegram Botã€‚ä¸»è¦è¾“å…¥æ¥æºæ˜¯Fusion Engineé€šè¿‡Webhookæ¨é€çš„èåˆäº‹ä»¶ã€‚

### 1.1 æ¥è‡ª Fusion Engine çš„å­—æ®µ

Fusion Engineæ¨é€çš„äº‹ä»¶åŒ…å«å®Œæ•´çš„èåˆä¿¡æ¯å’Œè´å¶æ–¯è¯„åˆ†ï¼Œè¿™äº›å­—æ®µç”±Normalize EventèŠ‚ç‚¹è§£æå’Œæ ‡å‡†åŒ–ã€‚

**å®Œæ•´å­—æ®µåˆ—è¡¨**:

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `source` | string | âœ… | äº‹ä»¶æ¥æºæ ‡è¯†ç¬¦ï¼ˆå¦‚`ws_binance`ã€`tg_alpha_intel`ï¼‰ |
| `raw_text` | string | âœ… | åŸå§‹æ¶ˆæ¯æ–‡æœ¬ |
| `exchange` | string | âŒ | äº¤æ˜“æ‰€åç§°ï¼ˆå¦‚`binance`ã€`okx`ï¼‰ |
| `symbol` | string | âŒ | ä»£å¸ç¬¦å·ï¼ˆå•ä¸ªï¼‰ |
| `symbols` | string | âŒ | ä»£å¸ç¬¦å·åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼‰ |
| `event` | string | âŒ | äº‹ä»¶ç±»å‹ï¼ˆ`listing`ã€`trading_open`ç­‰ï¼‰ |
| `url` | string | âŒ | ç›¸å…³URLé“¾æ¥ |
| `ts` | number | âŒ | æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ |
| `score` | number | âŒ | è´å¶æ–¯ç»¼åˆè¯„åˆ†ï¼ˆ0-100ï¼‰ |
| `is_first` | boolean | âŒ | æ˜¯å¦é¦–å‘ä¿¡å· |
| `source_count` | number | âŒ | ç¡®è®¤æ¥æºæ•°é‡ |
| `_fusion` | object | âŒ | å®Œæ•´èåˆä¿¡æ¯ |
| `score_detail` | object | âŒ | è¯„åˆ†è¯¦æƒ… |

**Fusion Engineæ¨é€ç¤ºä¾‹**:

```json
{
  "source": "ws_binance",
  "raw_text": "New trading pair: PURR-USDT trading starts at 2025-12-03 10:00 UTC",
  "exchange": "binance",
  "symbols": "PURR",
  "event": "listing",
  "url": "https://www.binance.com/en/support/announcement/...",
  "ts": 1764590423819,
  "score": 67.5,
  "is_first": true,
  "source_count": 2,
  "_fusion": {
    "sources": ["ws_binance", "tg_alpha_intel"],
    "source_confidence": 0.84,
    "bayesian_score": 67.5,
    "is_first": true,
    "aggregation_window": 5,
    "score_detail": {
      "source_score": 65,
      "multi_source_score": 20,
      "timeliness_score": 20,
      "exchange_score": 15
    }
  }
}
```

**Telegramæ¶ˆæ¯æ ¼å¼**:

å½“ä¿¡å·é€šè¿‡Telegram Botè¾“å…¥æ—¶ï¼ŒNormalize Eventä¼šè§£æç‰¹å®šæ ¼å¼çš„æ¶ˆæ¯ç»“æ„ï¼š

```
ğŸ“¢ æ ‡é¢˜: Binanceå°†ä¸Šçº¿PURR
ğŸ¢ äº¤æ˜“æ‰€: binance
ğŸ’ å¸ç§: PURR, MEOW
ğŸ”— é“¾æ¥: https://...
```

---

### 1.2 æœ€å°å­—æ®µè¦æ±‚

ä¸ºç¡®ä¿å·¥ä½œæµæ­£å¸¸è¿è¡Œï¼Œè¾“å…¥äº‹ä»¶å¿…é¡»æ»¡è¶³ä»¥ä¸‹æœ€å°å­—æ®µè¦æ±‚ï¼š

**å¿…å¡«å­—æ®µ**:

| å­—æ®µ | è¦æ±‚ | é»˜è®¤å€¼ |
|------|------|--------|
| `source` | å¿…é¡»å­˜åœ¨ä¸”éç©º | `"unknown"` |
| `raw_text` | å¿…é¡»å­˜åœ¨ï¼Œç”¨äºAIåˆ†æ | `""` |

**æ¨èå­—æ®µ**ï¼ˆå½±å“è¯„åˆ†å’Œè¿‡æ»¤ï¼‰:

| å­—æ®µ | å½±å“ | ç¼ºå¤±æ—¶è¡Œä¸º |
|------|------|------------|
| `score` | å†³å®šå¿«é€Ÿé€šé“èµ„æ ¼ | é»˜è®¤50åˆ†ï¼Œèµ°AIåˆ†æ |
| `exchange` | å½±å“äº¤æ˜“æ‰€çº§åˆ«è¯„åˆ† | é»˜è®¤ç©ºï¼ŒAIå°è¯•è¯†åˆ« |
| `symbols` | å†³å®šäº¤æ˜“æ ‡çš„ | ä»raw_textæ­£åˆ™æå– |

**Normalize Eventæ ‡å‡†åŒ–è¾“å‡º**:

```javascript
{
  source: String(source),           // æ¥æºæ ‡è¯†
  raw_text: String(rawText),        // åŸå§‹æ–‡æœ¬
  symbol_hint: Array,               // ä»£å¸åˆ—è¡¨
  exchange: String(exchange),       // äº¤æ˜“æ‰€
  url: String(url),                 // URL
  ts: parseInt(input.ts) || Date.now(),
  
  // è´å¶æ–¯è¯„åˆ†å­—æ®µ
  bayesian_score: Number,           // 0-100
  is_first: Boolean,                // æ˜¯å¦é¦–å‘
  source_count: Number,             // æ¥æºæ•°é‡
  
  // å…¼å®¹å­—æ®µ
  source_confidence: Number,        // 0-1ï¼ˆbayesian_score/100ï¼‰
  sources: Array,                   // æ¥æºåˆ—è¡¨
  
  // å®Œæ•´èåˆä¿¡æ¯
  _fusion: Object
}
```

---

## 2. AI åˆ†æå±‚ï¼ˆDeepSeekï¼‰

AIåˆ†æå±‚ä½¿ç”¨GPT-4o-miniæ¨¡å‹ï¼ˆé€šè¿‡OpenAI APIå…¼å®¹æ¥å£é…ç½®ä¸ºDeepSeekï¼‰å¯¹ä¸Šå¸äº‹ä»¶è¿›è¡Œå¤šç»´åº¦è¯„ä¼°ã€‚è¯¥å±‚æ˜¯ç³»ç»Ÿçš„æ™ºèƒ½æ ¸å¿ƒï¼Œè´Ÿè´£åˆ¤æ–­ä¿¡å·çš„çœŸå®æ€§ã€å½±å“åŠ›å’Œç´§æ€¥ç¨‹åº¦ã€‚

### 2.1 åˆ†ç±»æ¨¡å‹

AIåˆ†æå™¨ï¼ˆListing Event Analyzerï¼‰å°†äº‹ä»¶åˆ†ç±»ä¸ºå››ç§ç±»å‹ï¼Œæ¯ç§ç±»å‹å¯¹åº”ä¸åŒçš„å¤„ç†ç­–ç•¥ã€‚

**äº‹ä»¶åˆ†ç±»å®šä¹‰**:

| ç±»åˆ« | æ ‡è¯† | è¯´æ˜ | äº¤æ˜“ä»·å€¼ |
|------|------|------|----------|
| ä¸Šå¸ | `listing` | æ–°äº¤æ˜“å¯¹ä¸Šçº¿ã€ç°è´§/åˆçº¦ä¸Šå¸‚ | â­â­â­ æœ€é«˜ |
| ä¸‹æ¶ | `delisting` | äº¤æ˜“å¯¹ç§»é™¤ã€é€€å¸‚ | âš ï¸ åšç©ºæœºä¼š |
| å‡çº§ | `upgrade` | ç½‘ç»œå‡çº§ã€ç»´æŠ¤ã€è¿ç§» | â­ æœ‰é™ |
| å…¶ä»– | `other` | æ–°é—»ã€ç ”æŠ¥ã€åˆä½œå…¬å‘Š | âŒ æ— ç›´æ¥ä»·å€¼ |

**åˆ†ç±»è§¦å‘å…³é”®è¯**:

```javascript
// Listing åˆ†ç±»è§¦å‘è¯
const LISTING_KEYWORDS = [
  'listing', 'list', 'will list', 'new trading pair',
  'launches', 'trading open', 'deposit open',
  'ä¸Šå¸', 'ä¸Šçº¿', 'å¼€æ”¾äº¤æ˜“', 'å¼€æ”¾å……å€¼'
];

// Delisting åˆ†ç±»è§¦å‘è¯
const DELISTING_KEYWORDS = [
  'delist', 'remove', 'suspend', 'halt',
  'ä¸‹æ¶', 'æš‚åœäº¤æ˜“', 'ç§»é™¤'
];

// Upgrade åˆ†ç±»è§¦å‘è¯
const UPGRADE_KEYWORDS = [
  'upgrade', 'maintenance', 'migration', 'hardfork',
  'å‡çº§', 'ç»´æŠ¤', 'è¿ç§»'
];
```

**AI System Promptæ ¸å¿ƒé€»è¾‘**:

```
You are a cryptocurrency listing event analyzer. Analyze signals objectively 
with BALANCED sensitivity.

=== KEY PRINCIPLES ===
1. WebSocket signals from exchanges are GENERALLY RELIABLE
2. Missing URL is NORMAL for WebSocket/API signals - do not heavily penalize
3. Balance between avoiding false positives AND capturing real opportunities
4. "New trading pair" messages from exchange WebSockets are usually genuine
```

---

### 2.2 å¯ä¿¡åº¦è¯„åˆ†

AIåˆ†æå™¨è¾“å‡ºå¤šä¸ªè¯„åˆ†ç»´åº¦ï¼Œå…±åŒå†³å®šä¿¡å·æ˜¯å¦åº”è¯¥è§¦å‘äº¤æ˜“ã€‚

**Structured Output Schema**:

```json
{
  "type": "object",
  "properties": {
    "symbol": {
      "type": "string",
      "description": "ä»£å¸ç¬¦å·ï¼ˆå¦‚ BTCã€ETHã€PURRï¼‰"
    },
    "targets": {
      "type": "array",
      "items": { "type": "string" },
      "description": "äº¤æ˜“å¯¹æ•°ç»„ï¼ˆå¦‚ ['PURR/USDT']ï¼‰"
    },
    "class": {
      "type": "string",
      "enum": ["listing", "delisting", "upgrade", "other"]
    },
    "is_real": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "çœŸå®æ€§è¯„åˆ†ï¼ˆ0=å®Œå…¨è™šå‡ï¼Œ1=å®Œå…¨çœŸå®ï¼‰"
    },
    "impact": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "å½±å“åŠ›è¯„åˆ†ï¼ˆ0=æ— å½±å“ï¼Œ1=é‡å¤§å½±å“ï¼‰"
    },
    "urgency": {
      "type": "string",
      "enum": ["immediate", "high", "medium", "low"]
    },
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "AIå¯¹æ­¤åˆ¤æ–­çš„ä¿¡å¿ƒç¨‹åº¦"
    },
    "red_flags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "æ£€æµ‹åˆ°çš„å¯ç–‘æ ‡å¿—"
    }
  },
  "required": ["symbol", "targets", "class", "is_real", "impact", "urgency", "confidence", "red_flags"]
}
```

**is_realï¼ˆçœŸå®æ€§ï¼‰è¯„åˆ†è§„åˆ™**:

| æ¡ä»¶ | åˆ†æ•°è°ƒæ•´ |
|------|----------|
| WebSocketæ¥æºï¼ˆws_*ï¼‰ | åŸºç¡€åˆ†0.5 |
| å®˜æ–¹å…¬å‘ŠURLå­˜åœ¨ | +0.2 |
| å…·ä½“æ—¥æœŸ/æ—¶é—´ | +0.1 |
| äº¤æ˜“å¯¹è¯¦æƒ…å®Œæ•´ | +0.1 |
| æ¨¡ç³Šæ—¶é—´è¡¨è¿° | -0.1 |
| æœªæŒ‡å®šäº¤æ˜“å¯¹ | -0.1 |
| æ¨å¹¿æ€§è¯­è¨€ | -0.2 |
| éå®˜æ–¹æ¥æº | -0.2 |

**impactï¼ˆå½±å“åŠ›ï¼‰è¯„åˆ†è§„åˆ™**:

| äº¤æ˜“æ‰€å±‚çº§ | åŸºç¡€åˆ† |
|------------|--------|
| Tier 1 (Binance, Coinbase) | 0.9 |
| Tier 2 (OKX, Bybit, KuCoin) | 0.7 |
| Tier 3 (Gate.io, MEXC, HTX) | 0.6 |
| Tier 4 (Bitget, LBank) | 0.5 |
| Tier 5 (Unknown) | 0.3 |

**urgencyï¼ˆç´§æ€¥ç¨‹åº¦ï¼‰å®šä¹‰**:

| çº§åˆ« | æ—¶é—´èŒƒå›´ | æ“ä½œå»ºè®® |
|------|----------|----------|
| immediate | 1å°æ—¶å†…æˆ–å·²ç”Ÿæ•ˆ | ç«‹å³æ‰§è¡Œ |
| high | 24å°æ—¶å†… | ä¼˜å…ˆå¤„ç† |
| medium | 1-7å¤© | è®¡åˆ’æ‰§è¡Œ |
| low | >7å¤©æˆ–æœªçŸ¥ | è§‚å¯Ÿç­‰å¾… |

---

### 2.3 é£é™©æç¤ºæ¨¡å‹

AIåˆ†æå™¨é€šè¿‡red_flagså­—æ®µè¾“å‡ºæ£€æµ‹åˆ°çš„é£é™©æ ‡å¿—ï¼Œè¿™äº›æ ‡å¿—ç”¨äºè¿‡æ»¤å¯ç–‘ä¿¡å·ã€‚

**Red Flagsç±»å‹**:

| æ ‡å¿— | å«ä¹‰ | è§¦å‘æ¡ä»¶ |
|------|------|----------|
| `promotional` | æ¨å¹¿æ€§è¯­è¨€ | åŒ…å«ğŸš€ã€moonã€100xç­‰å¤¸å¼ è¡¨è¿° |
| `unofficial_source` | éå®˜æ–¹æ¥æº | æ¥æºéäº¤æ˜“æ‰€å®˜æ–¹æ¸ é“ |
| `vague_time` | æ—¶é—´æ¨¡ç³Š | æ— å…·ä½“æ—¶é—´ï¼Œä½¿ç”¨"soon"ç­‰è¡¨è¿° |
| `suspicious_token` | å¯ç–‘ä»£å¸ | ä»£å¸åç§°ç¬¦åˆè¯ˆéª—æ¨¡å¼ |
| `no_url` | æ— é“¾æ¥ | ç¼ºå°‘å¯éªŒè¯çš„URL |
| `contradictory` | ä¿¡æ¯çŸ›ç›¾ | å†…å®¹è‡ªç›¸çŸ›ç›¾ |
| `duplicate_alert` | é‡å¤è­¦å‘Š | ä¸è¿‘æœŸäº‹ä»¶é«˜åº¦ç›¸ä¼¼ |

**Red Flagså¤„ç†è§„åˆ™**:

```javascript
// è¿‡æ»¤æ¡ä»¶
const FILTER_CONDITIONS = {
  max_red_flags: 3,           // çº¢æ——æ•°é‡ä¸Šé™
  blocking_flags: [           // é˜»æ–­æ€§çº¢æ——ï¼ˆå•ä¸ªå³æ‹¦æˆªï¼‰
    'suspicious_token',
    'contradictory'
  ]
};

function shouldFilter(redFlags) {
  // é˜»æ–­æ€§çº¢æ——æ£€æŸ¥
  for (const flag of FILTER_CONDITIONS.blocking_flags) {
    if (redFlags.includes(flag)) return true;
  }
  
  // ç´¯è®¡çº¢æ——æ£€æŸ¥
  return redFlags.length >= FILTER_CONDITIONS.max_red_flags;
}
```

---

## 3. ä¿¡å·è¿‡æ»¤å±‚ï¼ˆFilteringï¼‰

ä¿¡å·è¿‡æ»¤å±‚é€šè¿‡å¤šé‡æœºåˆ¶ç¡®ä¿åªæœ‰é«˜è´¨é‡ä¿¡å·è¿›å…¥æ‰§è¡Œé˜¶æ®µï¼ŒåŒ…æ‹¬å†…å®¹å»é‡ã€ç½®ä¿¡åº¦è¿‡æ»¤ã€é»‘åå•æ£€æŸ¥å’Œé™æµæ§åˆ¶ã€‚

### 3.1 å»é‡

å»é‡æœºåˆ¶é€šè¿‡SHA256å†…å®¹å“ˆå¸Œå’ŒRedis SET NXæ“ä½œå®ç°ï¼Œç¡®ä¿ç›¸åŒå†…å®¹çš„ä¿¡å·åœ¨æŒ‡å®šæ—¶é—´çª—å£å†…åªå¤„ç†ä¸€æ¬¡ã€‚

**å»é‡æµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DEDUP FLOW                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Generate Content Hash                      â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  const hash = crypto.createHash('sha256')                â”‚  â”‚
â”‚  â”‚    .update(text.trim().toLowerCase())                    â”‚  â”‚
â”‚  â”‚    .digest('hex');                                       â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  dedup_key = `signal:hash:${hash}`                       â”‚  â”‚
â”‚  â”‚  dedup_ttl = 300 (5åˆ†é’Ÿ)                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                    â”‚
â”‚                           â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Redis SET NX                               â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  SET signal:hash:abc123... value EX 300 NX               â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  è¿”å›å€¼:                                                 â”‚  â”‚
â”‚  â”‚  - 1 = è®¾ç½®æˆåŠŸï¼ˆkeyä¸å­˜åœ¨ï¼‰â†’ æ–°ä¿¡å·                    â”‚  â”‚
â”‚  â”‚  - 0 = è®¾ç½®å¤±è´¥ï¼ˆkeyå·²å­˜åœ¨ï¼‰â†’ é‡å¤ä¿¡å·                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                    â”‚
â”‚                           â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Parse Dedup Result                         â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  is_duplicate = (redisResult === 0)                      â”‚  â”‚
â”‚  â”‚  dedup_status = is_duplicate ? 'duplicate' : 'new'       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                    â”‚
â”‚                           â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Filter Duplicates                          â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  if (is_duplicate === false) â†’ ç»§ç»­å¤„ç†                 â”‚  â”‚
â”‚  â”‚  if (is_duplicate === true)  â†’ ä¸¢å¼ƒ                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å»é‡é…ç½®**:

```yaml
dedup:
  window_seconds: 300        # å»é‡çª—å£ï¼š5åˆ†é’Ÿ
  hash_algorithm: sha256     # å“ˆå¸Œç®—æ³•
  key_prefix: "signal:hash:" # Redis keyå‰ç¼€
  
  # Redisè¿æ¥
  redis:
    host: 139.180.133.81
    port: 6379
    password: "OiONEfYjv9qKxLrsrLe8b0Q+5Ik2fjibxmH6zAuZqhE="
```

---

### 3.2 ç½®ä¿¡åº¦è¿‡æ»¤

Filter High Quality SignalsèŠ‚ç‚¹åŸºäºAIåˆ†æç»“æœè¿›è¡Œå¤šç»´åº¦è¿‡æ»¤ï¼Œåªæœ‰æ»¡è¶³è´¨é‡é˜ˆå€¼çš„ä¿¡å·æ‰èƒ½è¿›å…¥æ‰§è¡Œé˜¶æ®µã€‚

**è¿‡æ»¤æ¡ä»¶ï¼ˆORé€»è¾‘ï¼‰**:

```javascript
const FILTER_CONDITIONS = {
  // çœŸå®æ€§è¯„åˆ† >= 0.4
  is_real: { operator: 'gte', value: 0.4 },
  
  // å½±å“åŠ›è¯„åˆ† >= 0.5
  impact: { operator: 'gte', value: 0.5 },
  
  // ç½®ä¿¡åº¦ > 0.4
  confidence: { operator: 'gt', value: 0.4 },
  
  // çº¢æ——æ•°é‡ < 3
  red_flags_length: { operator: 'lt', value: 3 },
  
  // äº‹ä»¶ç±»å‹ = listing
  class: { operator: 'equals', value: 'listing' }
};

// æ»¡è¶³ä»»æ„ä¸€ä¸ªæ¡ä»¶å³é€šè¿‡ï¼ˆORé€»è¾‘ï¼‰
function shouldPass(output) {
  return (
    output.is_real >= 0.4 ||
    output.impact >= 0.5 ||
    output.confidence > 0.4 ||
    output.red_flags.length < 3 ||
    output.class === 'listing'
  );
}
```

**å¿«é€Ÿé€šé“ï¼ˆBayesian Fast Trackï¼‰**:

é«˜è´å¶æ–¯è¯„åˆ†çš„ä¿¡å·å¯è·³è¿‡AIåˆ†æï¼Œç›´æ¥è¿›å…¥æ‰§è¡Œé˜¶æ®µï¼Œæ˜¾è‘—é™ä½å»¶è¿Ÿã€‚

```javascript
// å¿«é€Ÿé€šé“è§¦å‘æ¡ä»¶
const FAST_TRACK_CONDITIONS = {
  high_score: bayesianScore >= 60,                    // é«˜è´å¶æ–¯åˆ†
  multi_source_first: isFirst && sourceCount >= 2,   // é¦–æ¬¡+å¤šæºç¡®è®¤
  medium_score_multi: bayesianScore >= 40 && sourceCount >= 3  // ä¸­åˆ†+å¤šæº
};

const fastTrack = 
  FAST_TRACK_CONDITIONS.high_score ||
  FAST_TRACK_CONDITIONS.multi_source_first ||
  FAST_TRACK_CONDITIONS.medium_score_multi;
```

**å¿«é€Ÿé€šé“è¾“å‡ºæ ¼å¼**:

```javascript
{
  output: {
    symbol: symbol,
    targets: [symbol],
    class: 'listing',
    is_real: Math.min(0.5 + (bayesianScore / 100) * 0.4, 0.85),
    impact: exchangeTier,  // æ ¹æ®æ¥æºæ¨æ–­
    urgency: isFirst ? 'immediate' : 'high',
    confidence: Math.min(0.4 + (sourceCount * 0.1) + (bayesianScore / 200), 0.8),
    red_flags: []
  },
  fast_tracked: true
}
```

---

### 3.3 é»‘åå•

ç³»ç»Ÿç»´æŠ¤å¤šä¸ªé»‘åå•ç”¨äºè¿‡æ»¤æ— æ•ˆæˆ–å±é™©çš„äº¤æ˜“æ ‡çš„ã€‚

**ä»£å¸é»‘åå•**:

```javascript
const SYMBOL_BLACKLIST = [
  // ç¨³å®šå¸
  'USDT', 'USDC', 'BUSD', 'DAI', 'TUSD', 'USDP',
  
  // ä¸»æµå¸ï¼ˆå·²æœ‰æŒä»“æˆ–æµåŠ¨æ€§è¿‡å¤§ï¼‰
  'BTC', 'ETH', 'BNB', 'SOL', 'XRP',
  
  // åŒ…è£…ä»£å¸
  'WBTC', 'WETH', 'WBNB',
  
  // å·²çŸ¥è¯ˆéª—ä»£å¸æ¨¡å¼
  // (åŠ¨æ€æ›´æ–°)
];

function isBlacklisted(symbol) {
  return SYMBOL_BLACKLIST.includes(symbol.toUpperCase());
}
```

**äº¤æ˜“æ‰€é»‘åå•**:

```javascript
const EXCHANGE_BLACKLIST = [
  // å·²çŸ¥ä¸å¯é äº¤æ˜“æ‰€
  // (æ ¹æ®è¿è¥æƒ…å†µåŠ¨æ€è°ƒæ•´)
];
```

---

### 3.4 é™æµæ§åˆ¶

é™æµæœºåˆ¶é˜²æ­¢ç³»ç»Ÿåœ¨çŸ­æ—¶é—´å†…æ‰§è¡Œè¿‡å¤šäº¤æ˜“ï¼Œä¿æŠ¤èµ„é‡‘å®‰å…¨ã€‚

**é™æµé…ç½®**:

```yaml
rate_limits:
  max_trades_per_symbol: 1    # å•å¸ç§æœ€å¤§äº¤æ˜“æ¬¡æ•°
  cooldown_seconds: 30        # åŒå¸ç§äº¤æ˜“å†·å´æœŸ
  exchange_lock_hours: 1      # äº¤æ˜“æ‰€é”å®šæ—¶é—´
```

**é™æµå®ç°**:

```javascript
// å•å¸ç§é™åˆ¶
const symbolKey = `trade:symbol:${symbol}`;
const tradeCount = await redis.get(symbolKey);
if (tradeCount >= config.MAX_TRADES_PER_SYMBOL) {
  throw new Error(`${symbol} å·²è¾¾äº¤æ˜“æ¬¡æ•°ä¸Šé™`);
}

// å†·å´æœŸæ£€æŸ¥
const cooldownKey = `cooldown:${symbol}`;
if (await redis.exists(cooldownKey)) {
  throw new Error(`${symbol} åœ¨å†·å´æœŸå†…`);
}

// äº¤æ˜“åè®¾ç½®å†·å´
await redis.setex(cooldownKey, 30, '1');
await redis.incr(symbolKey);
await redis.expire(symbolKey, 3600);
```

---

## 4. é£æ§å±‚ï¼ˆRisk Managementï¼‰

é£æ§å±‚åœ¨ç­–ç•¥ç”Ÿæˆå’Œäº¤æ˜“æ‰§è¡Œä¹‹é—´å®æ–½å¤šé‡ä¿æŠ¤æœºåˆ¶ï¼Œç¡®ä¿äº¤æ˜“é£é™©å¯æ§ã€‚

### 4.1 æ­¢ç›ˆæ­¢æŸæ¨¡å‹

ç³»ç»Ÿé‡‡ç”¨ç™¾åˆ†æ¯”æ­¢ç›ˆæ­¢æŸæ¨¡å‹ï¼Œåœ¨å¼€ä»“æ—¶é¢„è®¾é€€å‡ºæ¡ä»¶ã€‚

**é»˜è®¤é…ç½®**:

```yaml
risk_management:
  tp: 10          # æ­¢ç›ˆï¼š10%
  sl: 1           # æ­¢æŸï¼š1%ï¼ˆä¿å®ˆè®¾ç½®ï¼‰
  timeout: 3600   # è¶…æ—¶ï¼š1å°æ—¶ï¼ˆ3600ç§’ï¼‰
```

**æ­¢ç›ˆæ­¢æŸè®¡ç®—**:

```javascript
// å…¥åœºä»·æ ¼
const entryPrice = currentPrice;

// æ­¢ç›ˆä»·æ ¼
const takeProfitPrice = entryPrice * (1 + tp / 100);

// æ­¢æŸä»·æ ¼
const stopLossPrice = entryPrice * (1 - sl / 100);

// ç¤ºä¾‹ï¼šå…¥åœºä»·$1.00ï¼ŒTP=10%ï¼ŒSL=1%
// æ­¢ç›ˆä»· = $1.00 * 1.10 = $1.10
// æ­¢æŸä»· = $1.00 * 0.99 = $0.99
```

**Position Monitorè§¦å‘æ¡ä»¶**:

```javascript
// æ­¢ç›ˆè§¦å‘
if (currentPrice >= takeProfitPrice) {
  await closePosition('take_profit');
}

// æ­¢æŸè§¦å‘
if (currentPrice <= stopLossPrice) {
  await closePosition('stop_loss');
}

// è¶…æ—¶è§¦å‘
if (Date.now() - openTime >= timeout * 1000) {
  await closePosition('timeout');
}
```

---

### 4.2 å•å¸ç§é™åˆ¶

é˜²æ­¢åœ¨åŒä¸€ä»£å¸ä¸Šè¿‡åº¦é›†ä¸­é£é™©ã€‚

**é…ç½®**:

```yaml
position_limits:
  max_trades_per_symbol: 1    # åŒå¸ç§æœ€å¤š1ç¬”æœªå¹³ä»“
  max_exposure_per_symbol: 500  # å•å¸ç§æœ€å¤§æ•å£$500
```

**éªŒè¯é€»è¾‘**:

```javascript
function validateSymbolLimit(symbol, usdAmount) {
  const existingPosition = await getOpenPosition(symbol);
  
  if (existingPosition) {
    throw new Error(`${symbol} å·²æœ‰æœªå¹³ä»“å¤´å¯¸`);
  }
  
  if (usdAmount > config.MAX_EXPOSURE_PER_SYMBOL) {
    throw new Error(`${symbol} æ•å£è¶…é™: $${usdAmount}`);
  }
}
```

---

### 4.3 äº¤æ˜“æ‰€é™åˆ¶

å¯¹ç‰¹å®šäº¤æ˜“æ‰€å®æ–½äº¤æ˜“é”å®šï¼Œé˜²æ­¢å¯¹åŒä¸€äº¤æ˜“æ‰€äº‹ä»¶çš„é‡å¤ååº”ã€‚

**é”å®šæœºåˆ¶**:

```javascript
// äº¤æ˜“æ‰€é”å®šï¼ˆäº¤æ˜“å®Œæˆåï¼‰
const lockKey = `lock:exchange:${exchange}`;
await redis.setex(lockKey, config.EXCHANGE_LOCK_HOURS * 3600, '1');

// é”å®šæ£€æŸ¥ï¼ˆäº¤æ˜“å‰ï¼‰
if (await redis.exists(lockKey)) {
  throw new Error(`${exchange} å¤„äºé”å®šçŠ¶æ€`);
}
```

**é”å®šé…ç½®**:

```yaml
exchange_limits:
  lock_hours: 1              # äº¤æ˜“æ‰€é”å®šæ—¶é—´ï¼š1å°æ—¶
  max_trades_per_exchange: 3  # æ¯äº¤æ˜“æ‰€æ¯æ—¥æœ€å¤§äº¤æ˜“æ•°
```

---

### 4.4 æç«¯è¡Œæƒ…ä¿æŠ¤

ç³»ç»Ÿå†…ç½®å¤šé‡æç«¯è¡Œæƒ…ä¿æŠ¤æœºåˆ¶ã€‚

**é‡‘é¢ä¸Šé™**:

```javascript
// å•ç¬”äº¤æ˜“é‡‘é¢ä¸Šé™
const MAX_TRADE_AMOUNT = 10000;  // $10,000

if (usdAmount > MAX_TRADE_AMOUNT) {
  throw new Error(`é‡‘é¢è¶…é™: $${usdAmount} > $${MAX_TRADE_AMOUNT}`);
}
```

**å‚æ•°åˆæ³•æ€§æ ¡éªŒ**:

```javascript
function validateTradeParams(params) {
  const { tp, sl, usdAmount, symbol } = params;
  
  // TPå¿…é¡»å¤§äºSL
  if (tp <= sl) {
    throw new Error(`TP (${tp}) å¿…é¡»å¤§äº SL (${sl})`);
  }
  
  // TP/SLå¿…é¡»ä¸ºæ­£æ•°
  if (tp <= 0 || sl <= 0) {
    throw new Error('TP/SL å¿…é¡»å¤§äº0');
  }
  
  // é‡‘é¢å¿…é¡»ä¸ºæ­£æ•°
  if (usdAmount <= 0) {
    throw new Error(`æ— æ•ˆé‡‘é¢: ${usdAmount}`);
  }
  
  // æ ‡çš„ä¸èƒ½ä¸ºç©º
  if (!symbol || symbol.trim() === '') {
    throw new Error('äº¤æ˜“æ ‡çš„ä¸ºç©º');
  }
}
```

---

## 5. ç­–ç•¥ç”Ÿæˆå±‚ï¼ˆStrategy Generatorï¼‰

ç­–ç•¥ç”Ÿæˆå±‚æ ¹æ®ä¿¡å·è¯„åˆ†å’Œç³»ç»Ÿé…ç½®ï¼Œè®¡ç®—æœ€ä¼˜çš„ä»“ä½å¤§å°å’Œäº¤æ˜“å‚æ•°ã€‚

### 5.1 ä»“ä½è®¡ç®—

ä»“ä½è®¡ç®—é‡‡ç”¨åŸºäºè´å¶æ–¯è¯„åˆ†çš„åŠ¨æ€åˆ†é…æ¨¡å‹ï¼Œé«˜åˆ†ä¿¡å·è·å¾—æ›´å¤§ä»“ä½ã€‚

**æƒç›Šé…ç½®**:

```yaml
portfolio:
  equity: 3000               # æ€»æƒç›Šï¼š$3,000
  max_position_ratio: 0.10   # æœ€å¤§å•ç¬”æ¯”ä¾‹ï¼š10%
```

**åŠ¨æ€ä»“ä½æ¨¡å‹**:

```javascript
function calculatePositionRatio(bayesianScore, isFastTracked) {
  // å¿«é€Ÿé€šé“ï¼šå›ºå®š6%
  if (isFastTracked) {
    return { ratio: 0.06, level: 'ğŸš€ å¿«é€Ÿé€šé“' };
  }
  
  // é«˜åˆ†ä¿¡å·ï¼ˆ>=70ï¼‰ï¼š10%
  if (bayesianScore >= 70) {
    return { ratio: 0.10, level: 'ğŸ”¥ é«˜åˆ†' };
  }
  
  // ä¸­ç­‰ä¿¡å·ï¼ˆ>=50ï¼‰ï¼š5%
  if (bayesianScore >= 50) {
    return { ratio: 0.05, level: 'â­ ä¸­ç­‰' };
  }
  
  // ä½åˆ†ä¿¡å·ï¼ˆ>=35ï¼‰ï¼š3%
  if (bayesianScore >= 35) {
    return { ratio: 0.03, level: 'ğŸ“ ä½åˆ†' };
  }
  
  // æä½åˆ†ï¼ˆ<35ï¼‰ï¼š2%ï¼ˆä¿å®ˆï¼‰
  return { ratio: 0.02, level: 'âš ï¸ æä½' };
}

// è®¡ç®—å®é™…é‡‘é¢
const { ratio, level } = calculatePositionRatio(bayesianScore, isFastTracked);
const usdAmount = equity * ratio;
```

**ä»“ä½è®¡ç®—ç¤ºä¾‹**:

| è´å¶æ–¯è¯„åˆ† | ä»“ä½æ¯”ä¾‹ | å®é™…é‡‘é¢ï¼ˆ$3000æƒç›Šï¼‰ |
|------------|----------|----------------------|
| 75 | 10% | $300 |
| 60 (å¿«é€Ÿé€šé“) | 6% | $180 |
| 55 | 5% | $150 |
| 40 | 3% | $90 |
| 25 | 2% | $60 |

---

### 5.2 è®¢å•ç»“æ„

Strategy Generatorè¾“å‡ºæ ‡å‡†åŒ–çš„è®¢å•ç»“æ„ï¼Œä¾›æ‰§è¡Œå±‚ä½¿ç”¨ã€‚

**è®¢å•ç»“æ„**:

```javascript
{
  symbol: "PURR",           // äº¤æ˜“æ ‡çš„
  usd_amount: 180,          // äº¤æ˜“é‡‘é¢ï¼ˆUSDï¼‰
  tp: 10,                   // æ­¢ç›ˆç™¾åˆ†æ¯”
  sl: 1,                    // æ­¢æŸç™¾åˆ†æ¯”
  timeout: 3600,            // è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
  venue: "hyperliquid",     // æ‰§è¡Œåœºæ‰€
  
  // é™„åŠ è¯„åˆ†ä¿¡æ¯
  bayesian_score: 67.5,     // è´å¶æ–¯è¯„åˆ†
  position_ratio: 0.06,     // ä»“ä½æ¯”ä¾‹
  score_level: "ğŸš€ å¿«é€Ÿé€šé“", // è¯„åˆ†çº§åˆ«
  fast_tracked: true        // æ˜¯å¦å¿«é€Ÿé€šé“
}
```

**Prepare Trade Configè½¬æ¢**:

```javascript
{
  configJson: {
    market: "PURR",                     // Hyperliquidå¸‚åœºåç§°
    size: "180",                        // äº¤æ˜“é‡‘é¢ï¼ˆå­—ç¬¦ä¸²ï¼‰
    main_wallet: "0xD2733d4f40a323aA7949a943e2Aa72D00f546B5B",
    agent_key: "0xd94520ba3eefe6ca4ce148631b1b2aa112060045e415568a4cf29d046a0bd8ee",
    tp: 10,                             // æ­¢ç›ˆ%
    sl: 1,                              // æ­¢æŸ%
    timeout: 3600                       // è¶…æ—¶ç§’
  }
}
```

---

### 5.3 æ—¶é—´çª—å£

äº¤æ˜“æ‰§è¡Œéµå¾ªä¸¥æ ¼çš„æ—¶é—´çª—å£æ§åˆ¶ã€‚

**æ—¶é—´å‚æ•°**:

```yaml
timing:
  trade_timeout: 3600        # ä»“ä½æŒæœ‰ä¸Šé™ï¼š1å°æ—¶
  http_timeout: 30000        # HTTPè¯·æ±‚è¶…æ—¶ï¼š30ç§’
  position_check_interval: 10  # æŒä»“æ£€æŸ¥é—´éš”ï¼š10ç§’
```

**è¶…æ—¶å¤„ç†**:

```javascript
// äº¤æ˜“æ‰§è¡Œè¶…æ—¶
if (Date.now() - orderTime > HTTP_TIMEOUT) {
  logError('äº¤æ˜“æ‰§è¡Œè¶…æ—¶');
  throw new Error('Trade execution timeout');
}

// ä»“ä½è¶…æ—¶
if (Date.now() - openTime > TRADE_TIMEOUT * 1000) {
  await closePosition('timeout_exit');
}
```

---

## 6. äº¤æ˜“æ‰§è¡Œå±‚ï¼ˆExecutionï¼‰

äº¤æ˜“æ‰§è¡Œå±‚è´Ÿè´£å°†ç­–ç•¥è½¬åŒ–ä¸ºå®é™…è®¢å•ï¼Œå¹¶é€šè¿‡å¤–éƒ¨APIæ‰§è¡Œäº¤æ˜“ã€‚

### 6.1 CEXï¼ˆGate/MEXCï¼‰

å½“å‰ç‰ˆæœ¬çš„n8nå·¥ä½œæµä¸»è¦é€šè¿‡Hyperliquidæ‰§è¡Œäº¤æ˜“ã€‚CEXæ‰§è¡Œå™¨ç”±ç‹¬ç«‹çš„PythonæœåŠ¡ï¼ˆcex_executor.pyï¼‰å®ç°ï¼Œé€šè¿‡Redis Streamæ¥æ”¶è·¯ç”±äº‹ä»¶ã€‚

**CEXæ‰§è¡Œå™¨æ¶æ„**ï¼ˆå‚è€ƒï¼‰:

```python
# CEXä¼˜å…ˆçº§
CEX_PRIORITY = {
    'gate': 1,   # ä¼˜å…ˆçº§æœ€é«˜
    'mexc': 2,
    'bitget': 3
}

# æ‰§è¡Œæµç¨‹
async def execute_cex_trade(event):
    for exchange in sorted(CEX_PRIORITY, key=CEX_PRIORITY.get):
        try:
            result = await exchange_clients[exchange].market_buy(
                symbol=event['symbol'],
                amount=event['size_usd']
            )
            if result['success']:
                return result
        except Exception as e:
            logger.warning(f'{exchange} æ‰§è¡Œå¤±è´¥: {e}')
            continue
    
    raise ExecutionError('æ‰€æœ‰CEXæ‰§è¡Œå¤±è´¥')
```

---

### 6.2 Hyperliquidï¼ˆEIP-712ï¼‰

Hyperliquidæ˜¯ä¸»è¦çš„äº¤æ˜“æ‰§è¡Œåœºæ‰€ï¼Œé€šè¿‡HTTP APIå’ŒEIP-712ç­¾åå®ç°æ— éœ€æ‰˜ç®¡çš„å»ä¸­å¿ƒåŒ–äº¤æ˜“ã€‚

**æ‰§è¡ŒAPIé…ç½®**:

```yaml
hyperliquid:
  api_endpoint: "https://hyperliquid-api-zeta.vercel.app/api/open"
  http_method: POST
  timeout: 30000
  
  # é’±åŒ…é…ç½®
  main_wallet: "0xD2733d4f40a323aA7949a943e2Aa72D00f546B5B"
  agent_private_key: "0xd94520ba3eefe6ca4ce148631b1b2aa112060045e415568a4cf29d046a0bd8ee"
```

**APIè¯·æ±‚æ ¼å¼**:

```json
{
  "market": "PURR",
  "size": "180",
  "main_wallet": "0xD2733d4f40a323aA7949a943e2Aa72D00f546B5B",
  "agent_key": "0xd94520ba3eefe6ca4ce148631b1b2aa112060045e415568a4cf29d046a0bd8ee",
  "tp": 10,
  "sl": 1,
  "timeout": 3600
}
```

**EIP-712ç­¾åæµç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  EIP-712 SIGNING FLOW                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. æ„å»ºäº¤æ˜“æ•°æ®                                                 â”‚
â”‚     {                                                            â”‚
â”‚       market: "PURR",                                            â”‚
â”‚       size: 180,                                                 â”‚
â”‚       side: "buy",                                               â”‚
â”‚       type: "market"                                             â”‚
â”‚     }                                                            â”‚
â”‚                                                                  â”‚
â”‚  2. æ„å»ºEIP-712ç±»å‹åŒ–æ•°æ®                                        â”‚
â”‚     {                                                            â”‚
â”‚       types: { ... },                                            â”‚
â”‚       primaryType: "Order",                                      â”‚
â”‚       domain: { name: "HyperLiquid", ... },                      â”‚
â”‚       message: { ... }                                           â”‚
â”‚     }                                                            â”‚
â”‚                                                                  â”‚
â”‚  3. ä½¿ç”¨agent_keyç­¾å                                            â”‚
â”‚     signature = sign(typedData, agentPrivateKey)                 â”‚
â”‚                                                                  â”‚
â”‚  4. å‘é€è‡³Hyperliquid API                                        â”‚
â”‚     POST /exchange with { action, signature, nonce, ... }       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 6.3 æ‰§è¡Œç»“æœè®°å½•

äº¤æ˜“æ‰§è¡Œåï¼Œç³»ç»Ÿè®°å½•å®Œæ•´çš„æ‰§è¡Œç»“æœç”¨äºè¿½è¸ªå’Œåˆ†æã€‚

**Parse Trade Resultè¾“å‡º**:

```javascript
{
  success: true,                    // æ‰§è¡Œæ˜¯å¦æˆåŠŸ
  payload: {
    market: "PURR",
    spot_pair: "PURR/USDC",
    size: 180.5,
    price: 1.23,
    usd_amount: 222.02,
    asset_index: 12345
  },
  response: { ... },                // å®Œæ•´APIå“åº”
  error: null,                      // é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœ‰ï¼‰
  tp: 10,
  sl: 1,
  timeout: 3600,
  timestamp: 1764590424000
}
```

**Build Trade Logè¾“å‡º**:

```javascript
{
  symbol: "PURR",
  size: 180.5,
  tp: 10,
  sl: 1,
  timeout: 3600,
  order_response: { status: "filled", ... },
  wallet_address: "0xD2733d4f40a323aA7949a943e2Aa72D00f546B5B",
  success: true,
  created_at: "2025-12-03T10:00:24.000Z",
  
  // Position Monitoréœ€è¦çš„å­—æ®µ
  market: "PURR",
  HL_MAIN_WALLET: "0xD2733d4f40a323aA7949a943e2Aa72D00f546B5B",
  HL_AGENT_PRIVATE_KEY: "0xd94520ba...",
  
  payload: {
    market: "PURR",
    size: 180.5,
    price: 1.23
  }
}
```

**å¤±è´¥äº¤æ˜“è®°å½•**:

```javascript
{
  status: "failed",
  error_message: "Insufficient balance",
  error_code: "INSUFFICIENT_FUNDS",
  failed_at: "2025-12-03T10:00:24.000Z",
  payload_sent: { ... }
}
```

---

## 7. é€šçŸ¥å±‚ï¼ˆNotificationï¼‰

é€šçŸ¥å±‚é€šè¿‡ä¼ä¸šå¾®ä¿¡å°†äº¤æ˜“æ‰§è¡Œç»“æœå®æ—¶æ¨é€ç»™ç”¨æˆ·ï¼Œæ”¯æŒæˆåŠŸé€šçŸ¥ã€é”™è¯¯å‘Šè­¦å’Œå‹ç¼©æ–‡æ¡ˆã€‚

### 7.1 ä¼ä¸šå¾®ä¿¡é€šçŸ¥æ ¼å¼

**Webhooké…ç½®**:

```yaml
wechat:
  webhook_url: "https://qyapi.weixin.qq.com/cgi-bin/webhook/send"
  webhook_key: "bb53accf-0993-45a2-a1f9-656e8dcfe215"
```

**æˆåŠŸäº¤æ˜“é€šçŸ¥æ ¼å¼**:

```json
{
  "msgtype": "markdown",
  "markdown": {
    "content": "## âœ… äº¤æ˜“æ‰§è¡ŒæˆåŠŸ\n\n**å¸ç§**: PURR\n**äº¤æ˜“å¯¹**: PURR/USDC\n**æ–¹å‘**: ä¹°å…¥\n**æ•°é‡**: 180.5 PURR\n**å…¥åœºä»·**: $1.23\n**é‡‘é¢**: $222.02\n\n---\n\n**æ­¢ç›ˆ**: 10% ($1.353)\n**æ­¢æŸ**: 1% ($1.218)\n**è¶…æ—¶**: 1å°æ—¶\n\n---\n\n**ä¿¡å·æ¥æº**: ws_binance\n**è´å¶æ–¯è¯„åˆ†**: 67.5\n**è¯„åˆ†çº§åˆ«**: ğŸš€ å¿«é€Ÿé€šé“\n\n**æ‰§è¡Œæ—¶é—´**: 2025-12-03 10:00:24"
  }
}
```

**é€šçŸ¥Markdownæ¨¡æ¿**:

```markdown
## âœ… äº¤æ˜“æ‰§è¡ŒæˆåŠŸ

**å¸ç§**: {{symbol}}
**äº¤æ˜“å¯¹**: {{spotPair}}
**æ–¹å‘**: ä¹°å…¥
**æ•°é‡**: {{size}} {{symbol}}
**å…¥åœºä»·**: ${{price}}
**é‡‘é¢**: ${{usdAmount}}

---

**æ­¢ç›ˆ**: {{tp}}% (${{tpPrice}})
**æ­¢æŸ**: {{sl}}% (${{slPrice}})
**è¶…æ—¶**: {{timeoutHours}}å°æ—¶

---

**ä¿¡å·æ¥æº**: {{source}}
**è´å¶æ–¯è¯„åˆ†**: {{bayesianScore}}
**è¯„åˆ†çº§åˆ«**: {{scoreLevel}}

**æ‰§è¡Œæ—¶é—´**: {{timestamp}}
```

---

### 7.2 é”™è¯¯å‘Šè­¦æ ¼å¼

**å¤±è´¥äº¤æ˜“å‘Šè­¦**:

```json
{
  "msgtype": "markdown",
  "markdown": {
    "content": "## âŒ äº¤æ˜“æ‰§è¡Œå¤±è´¥\n\n**å¸ç§**: PURR\n**é”™è¯¯ç±»å‹**: INSUFFICIENT_FUNDS\n**é”™è¯¯ä¿¡æ¯**: Insufficient balance for order\n\n---\n\n**è¯·æ±‚å‚æ•°**:\n- market: PURR\n- size: $180\n- tp: 10%\n- sl: 1%\n\n---\n\n**å¤±è´¥æ—¶é—´**: 2025-12-03 10:00:24\n\n> âš ï¸ è¯·æ£€æŸ¥è´¦æˆ·ä½™é¢æˆ–APIé…ç½®"
  }
}
```

**å¸¸è§é”™è¯¯ç±»å‹åŠå¤„ç†å»ºè®®**:

| é”™è¯¯ä»£ç  | å«ä¹‰ | å¤„ç†å»ºè®® |
|----------|------|----------|
| INSUFFICIENT_FUNDS | ä½™é¢ä¸è¶³ | æ£€æŸ¥USDCä½™é¢ |
| SYMBOL_NOT_FOUND | äº¤æ˜“å¯¹ä¸å­˜åœ¨ | ç¡®è®¤HLæ”¯æŒè¯¥ä»£å¸ |
| RATE_LIMITED | è¯·æ±‚é¢‘ç‡è¿‡é«˜ | ç­‰å¾…åé‡è¯• |
| SIGNATURE_INVALID | ç­¾åæ— æ•ˆ | æ£€æŸ¥ç§é’¥é…ç½® |
| TIMEOUT | è¯·æ±‚è¶…æ—¶ | æ£€æŸ¥ç½‘ç»œè¿æ¥ |

---

### 7.3 æˆäº¤ä¿¡æ¯å‹ç¼©æ–‡æ¡ˆ

å¯¹äºéœ€è¦å¿«é€Ÿæµè§ˆçš„åœºæ™¯ï¼Œç³»ç»Ÿæ”¯æŒç”Ÿæˆå‹ç¼©ç‰ˆé€šçŸ¥ã€‚

**å‹ç¼©æ ¼å¼**:

```
âœ… PURR | ä¹°å…¥ $222 @ $1.23 | TP:10% SL:1% | ğŸš€å¿«é€Ÿé€šé“ 67.5åˆ†
```

**å‹ç¼©æ ¼å¼æ¨¡æ¿**:

```javascript
function generateCompactMessage(trade) {
  const status = trade.success ? 'âœ…' : 'âŒ';
  const action = trade.success ? 'ä¹°å…¥' : 'å¤±è´¥';
  const scoreEmoji = trade.fast_tracked ? 'ğŸš€' : 
                     trade.bayesian_score >= 70 ? 'ğŸ”¥' : 
                     trade.bayesian_score >= 50 ? 'â­' : 'ğŸ“';
  
  return `${status} ${trade.symbol} | ${action} $${trade.usdAmount} @ $${trade.price} | TP:${trade.tp}% SL:${trade.sl}% | ${scoreEmoji}${trade.score_level} ${trade.bayesian_score}åˆ†`;
}
```

**ä¼ä¸šå¾®ä¿¡APIå“åº”**:

```json
{
  "errcode": 0,
  "errmsg": "ok"
}
```

---

## é™„å½•A: å·¥ä½œæµèŠ‚ç‚¹æ¸…å•

| èŠ‚ç‚¹åç§° | ç±»å‹ | ä½ç½® | åŠŸèƒ½ |
|----------|------|------|------|
| Webhook Trigger | webhook | å…¥å£ | æ¥æ”¶Fusion Engineæ¨é€ |
| Telegram Trigger | telegramTrigger | å…¥å£ | æ¥æ”¶Telegramæ¶ˆæ¯ |
| Webhook Config | set | é…ç½® | æ ‡è®°Webhookæ¥æº |
| Telegram Config | set | é…ç½® | æ ‡è®°Telegramæ¥æº |
| Workflow Configuration | set | é…ç½® | å…¨å±€å‚æ•°é…ç½® |
| Merge Events | merge | åˆå¹¶ | åˆå¹¶å¤šå…¥å£äº‹ä»¶ |
| Normalize Event | code | å¤„ç† | äº‹ä»¶æ ¼å¼æ ‡å‡†åŒ– |
| Generate Content Hash | code | å»é‡ | ç”ŸæˆSHA256å“ˆå¸Œ |
| Redis Dedup Check | redis | å»é‡ | Redis SET NXæ£€æŸ¥ |
| Parse Dedup Result | code | å»é‡ | è§£æå»é‡ç»“æœ |
| Filter Duplicates | if | è¿‡æ»¤ | è¿‡æ»¤é‡å¤äº‹ä»¶ |
| Bayesian Fast Track | code | è·¯ç”± | è´å¶æ–¯å¿«é€Ÿé€šé“åˆ¤æ–­ |
| Route by Fast Track | if | è·¯ç”± | å¿«é€Ÿé€šé“/AIåˆ†æåˆ†æµ |
| Listing Event Analyzer1 | agent | AIåˆ†æ | GPT-4o-miniäº‹ä»¶åˆ†æ |
| OpenAI Chat Model | lmChatOpenAi | AI | è¯­è¨€æ¨¡å‹ |
| Structured Output Parser | outputParser | AI | ç»“æ„åŒ–è¾“å‡ºè§£æ |
| Filter High Quality Signals | if | è¿‡æ»¤ | è´¨é‡é˜ˆå€¼è¿‡æ»¤ |
| Strategy Generator (HL) | code | ç­–ç•¥ | ä»“ä½è®¡ç®—å’Œç­–ç•¥ç”Ÿæˆ |
| Prepare Trade Config | code | æ‰§è¡Œ | äº¤æ˜“é…ç½®å‡†å¤‡ |
| Execute Trade via HTTP | httpRequest | æ‰§è¡Œ | Hyperliquid APIè°ƒç”¨ |
| Parse Trade Result | code | æ‰§è¡Œ | äº¤æ˜“ç»“æœè§£æ |
| Check Trade Success | if | æ‰§è¡Œ | æˆåŠŸ/å¤±è´¥åˆ†æµ |
| Build Trade Log | code | è®°å½• | æ„å»ºäº¤æ˜“æ—¥å¿— |
| Log Failed Trade | set | è®°å½• | å¤±è´¥äº¤æ˜“è®°å½• |
| Prepare WeChat Message | code | é€šçŸ¥ | ä¼ä¸šå¾®ä¿¡æ¶ˆæ¯æ„å»º |
| Send to WeChat | httpRequest | é€šçŸ¥ | å‘é€ä¼ä¸šå¾®ä¿¡é€šçŸ¥ |
| Parse WeChat Response | code | é€šçŸ¥ | è§£æå‘é€ç»“æœ |
| Trigger Position Monitor | executeWorkflow | ç›‘æ§ | è§¦å‘æŒä»“ç›‘æ§å·¥ä½œæµ |

---

## é™„å½•B: é…ç½®å‚æ•°é€ŸæŸ¥

```yaml
# å·¥ä½œæµå…¨å±€é…ç½®
EQUITY: 3000                    # æ€»æƒç›Š $3000
TP: 10                          # æ­¢ç›ˆ 10%
SL: 1                           # æ­¢æŸ 1%
TIMEOUT: 3600                   # è¶…æ—¶ 1å°æ—¶

# å»é‡é…ç½®
DEDUP_WINDOW_SECONDS: 300       # å»é‡çª—å£ 5åˆ†é’Ÿ
MAX_TRADES_PER_SYMBOL: 1        # å•å¸ç§æœ€å¤§äº¤æ˜“æ¬¡æ•°

# äº¤æ˜“æ‰€é”å®š
EXCHANGE_LOCK_HOURS: 1          # äº¤æ˜“æ‰€é”å®š 1å°æ—¶

# Redisé…ç½®
REDIS_HOST: 139.180.133.81
REDIS_PORT: 6379
REDIS_PASSWORD: OiONEfYjv9qKxLrsrLe8b0Q+5Ik2fjibxmH6zAuZqhE=

# Hyperliquidé…ç½®
HL_MAIN_WALLET: 0xD2733d4f40a323aA7949a943e2Aa72D00f546B5B
HL_AGENT_PRIVATE_KEY: 0xd94520ba3eefe6ca4ce148631b1b2aa112060045e415568a4cf29d046a0bd8ee

# AIé…ç½®
DEEPSEEK_API_KEY: sk-624d2831ef2f4b2b9f3e2fdb1eb0d214
```

---

## é™„å½•C: ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|------|------|----------|
| v1.0 | 2025-10 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€Webhook+æ‰§è¡Œ |
| v2.0 | 2025-11 | æ·»åŠ AIåˆ†æå±‚ |
| v3.0 | 2025-11 | æ·»åŠ Rediså»é‡ |
| v8.3 | 2025-12 | è´å¶æ–¯å¿«é€Ÿé€šé“ï¼Œå½“å‰ç‰ˆæœ¬ |

---

**æ–‡æ¡£ç»“æŸ**

*æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†n8nå†³ç­–æµçš„å®Œæ•´æ¶æ„å’Œå¤„ç†é€»è¾‘ã€‚æ‰€æœ‰é…ç½®å‚æ•°å’Œä»£ç ç¤ºä¾‹å‡åŸºäºå®é™…è¿è¡Œçš„å·¥ä½œæµï¼Œå¯ç›´æ¥ç”¨äºç³»ç»Ÿè°ƒä¼˜å’Œæ•…éšœæ’æŸ¥ã€‚*
