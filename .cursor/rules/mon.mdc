# Crypto Monitor v8.3 项目约定

## 架构模式
- 使用 asyncio 异步编程
- Redis Stream 作为消息队列
- 服务间通过 Redis 解耦
- 所有时间戳使用毫秒级 UTC

## 代码规范
- Python 3.12+
- 类型提示必须完整
- 文档字符串使用中文
- 错误处理必须 try-except
- 日志使用 logger 模块

## 目录结构
```
/root/v8.3_crypto_monitor/
├── redis_server/          # 核心服务
│   ├── fusion_engine_v3.py   # 信号融合
│   ├── scoring_engine.py     # 评分引擎
│   ├── signal_router.py      # 路由器
│   ├── wechat_pusher.py      # 企业微信推送
│   └── webhook_pusher.py     # Webhook推送
├── src/execution/         # 交易执行
│   ├── dex_consumer.py       # DEX消费者
│   ├── dex_executor.py       # 交易执行器
│   └── telegram_bot.py       # Telegram机器人
├── shared/                # 共享库
│   ├── redis_client.py       # Redis客户端
│   └── logger.py             # 日志工具
└── config.secret/         # 敏感配置（不提交Git）
```

## Redis Stream 键名
- events:raw - 原始事件
- events:fused - 融合后事件
- events:route:cex - CEX路由
- events:route:hl - Hyperliquid路由
- events:route:dex - DEX路由

## 评分系统
- 基础分: 60分
- 交易所乘数: Upbit(2.0), Bithumb(1.8), Binance(1.5)
- 新鲜度乘数: 5分钟内(1.3), 5-15分钟(1.1)
- 合约地址加分: +20分
- 触发阈值: 40分

## 企业微信推送
- 信号通知: key=1ceb8074...
- 交易结果: key=bb53accf...

## 关键字段约定
- symbols: 逗号分隔的代币符号（复数）
- contract_address: 合约地址（可为空）
- contract_chain: 链名称（ethereum/bsc/base等）
- has_contract: "0"或"1"字符串
- score: 浮点数评分